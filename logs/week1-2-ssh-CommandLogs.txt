
C:\Windows\System32>
C:\Windows\System32>
C:\Windows\System32>
C:\Windows\System32>
C:\Windows\System32>
C:\Windows\System32>ssh specxy@192.168.1.102
The authenticity of host '192.168.1.102 (192.168.1.102)' can't be established.
ED25519 key fingerprint is SHA256:uvfi9raA0w6gocz8obP/bgivz7k0eaWVvcINai7poZ4.
This host key is known by the following other names/addresses:
    C:\Users\User/.ssh/known_hosts:1: 192.168.1.101
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.1.102' (ED25519) to the list of known hosts.
specxy@192.168.1.102's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Mon Aug 25 04:16:25 AM UTC 2025

  System load:  0.0                Processes:              251
  Usage of /:   43.8% of 18.53GB   Users logged in:        1
  Memory usage: 8%                 IPv4 address for ens33: 192.168.1.102
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Sat Aug 23 16:19:10 2025 from 192.168.1.2
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ whoami
specxy
specxy@siemserver:~$ java -version
openjdk version "21.0.8" 2025-07-15
OpenJDK Runtime Environment (build 21.0.8+9-Ubuntu-0ubuntu124.04.1)
OpenJDK 64-Bit Server VM (build 21.0.8+9-Ubuntu-0ubuntu124.04.1, mixed mode, sharing)
specxy@siemserver:~$ sudo apt update
[sudo] password for specxy:
Get:1 http://security.ubuntu.com/ubuntu noble-security InRelease [126 kB]
Hit:2 http://lk.archive.ubuntu.com/ubuntu noble InRelease
Get:3 http://lk.archive.ubuntu.com/ubuntu noble-updates InRelease [126 kB]
Get:4 http://security.ubuntu.com/ubuntu noble-security/main amd64 Components [21.6 kB]
Get:5 http://lk.archive.ubuntu.com/ubuntu noble-backports InRelease [126 kB]
Get:6 http://security.ubuntu.com/ubuntu noble-security/restricted amd64 Components [212 B]
Get:7 http://security.ubuntu.com/ubuntu noble-security/universe amd64 Components [52.2 kB]
Get:8 http://lk.archive.ubuntu.com/ubuntu noble-updates/main amd64 Packages [1,352 kB]
Get:9 http://security.ubuntu.com/ubuntu noble-security/multiverse amd64 Components [212 B]
Get:10 http://lk.archive.ubuntu.com/ubuntu noble-updates/main amd64 Components [175 kB]
Get:11 http://lk.archive.ubuntu.com/ubuntu noble-updates/restricted amd64 Components [212 B]
Get:12 http://lk.archive.ubuntu.com/ubuntu noble-updates/universe amd64 Packages [1,123 kB]
Get:13 http://lk.archive.ubuntu.com/ubuntu noble-updates/universe amd64 Components [377 kB]
Get:14 http://lk.archive.ubuntu.com/ubuntu noble-updates/multiverse amd64 Components [940 B]
Get:15 http://lk.archive.ubuntu.com/ubuntu noble-backports/main amd64 Components [7,068 B]
Get:16 http://lk.archive.ubuntu.com/ubuntu noble-backports/restricted amd64 Components [216 B]
Get:17 http://lk.archive.ubuntu.com/ubuntu noble-backports/universe amd64 Components [19.2 kB]
Get:18 http://lk.archive.ubuntu.com/ubuntu noble-backports/multiverse amd64 Components [212 B]
Hit:19 https://artifacts.elastic.co/packages/8.x/apt stable InRelease
Fetched 3,507 kB in 6s (597 kB/s)
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
All packages are up to date.
specxy@siemserver:~$ wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg
File '/usr/share/keyrings/elasticsearch-keyring.gpg' exists. Overwrite? (y/N) y
specxy@siemserver:~$ wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg
File '/usr/share/keyrings/elasticsearch-keyring.gpg' exists. Overwrite? (y/N) y
specxy@siemserver:~$ echo "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list
deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/8.x/apt stable main
specxy@siemserver:~$ sudo apt update
Hit:1 https://artifacts.elastic.co/packages/8.x/apt stable InRelease
Hit:2 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:3 http://lk.archive.ubuntu.com/ubuntu noble InRelease
Hit:4 http://lk.archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:5 http://lk.archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
All packages are up to date.
specxy@siemserver:~$ sudo apt install elasticsearch
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
elasticsearch is already the newest version (8.19.2).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
specxy@siemserver:~$ sudo nano /etc/elasticsearch/elasticsearch.yml
specxy@siemserver:~$ sudo systemctl enable elasticsearch
specxy@siemserver:~$ sudo systemctl start elasticsearch
specxy@siemserver:~$ sudo systemctl status elasticsearch
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Mon 2025-08-25 04:32:17 UTC; 10s ago
       Docs: https://www.elastic.co
   Main PID: 2713 (java)
      Tasks: 120 (limit: 4548)
     Memory: 2.3G (peak: 2.3G)
        CPU: 41.166s
     CGroup: /system.slice/elasticsearch.service
             ├─2713 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home>
             ├─2778 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Dj>
             └─2804 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 25 04:31:57 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 25 04:32:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.

specxy@siemserver:~$ curl -X GET "http://localhost:9200"
curl: (52) Empty reply from server
specxy@siemserver:~$ sudo nano /etc/elasticsearch/elasticsearch.yml
specxy@siemserver:~$ sudo systemctl status elasticsearch
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Mon 2025-08-25 04:32:17 UTC; 1min 30s ago
       Docs: https://www.elastic.co
   Main PID: 2713 (java)
      Tasks: 115 (limit: 4548)
     Memory: 2.3G (peak: 2.3G)
        CPU: 43.939s
     CGroup: /system.slice/elasticsearch.service
             ├─2713 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home>
             ├─2778 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Dj>
             └─2804 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 25 04:31:57 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 25 04:32:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.

specxy@siemserver:~$ curl -X GET "http://localhost:9200"
curl: (52) Empty reply from server
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-setup-passwords auto
04:44:19.136 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-25T04:44:19.134193192Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.authc.esnative.tool.SetupPasswordTool$SetupCommand.checkElasticKeystorePasswordValid(SetupPasswordTool.java:340) ~[?:?]
        at org.elasticsearch.xpack.security.authc.esnative.tool.SetupPasswordTool$AutoSetup.execute(SetupPasswordTool.java:147) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:95) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

SSL connection to https://192.168.1.102:9200/_security/_authenticate?pretty failed: (certificate_unknown) No subject alternative names matching IP address 192.168.1.102 found
Please check the elasticsearch SSL settings under xpack.security.http.ssl.


ERROR: Failed to establish SSL connection to elasticsearch at https://192.168.1.102:9200/_security/_authenticate?pretty., with exit code 78
specxy@siemserver:~$ sudo apt install kibana
[sudo] password for specxy:
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  kibana
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 383 MB of archives.
After this operation, 1,156 MB of additional disk space will be used.
Get:1 https://artifacts.elastic.co/packages/8.x/apt stable/main amd64 kibana amd64 8.19.2 [383 MB]
Fetched 383 MB in 2min 3s (3,119 kB/s)
Selecting previously unselected package kibana.
(Reading database ... 103988 files and directories currently installed.)
Preparing to unpack .../kibana_8.19.2_amd64.deb ...
Unpacking kibana (8.19.2) ...
Setting up kibana (8.19.2) ...
Creating kibana group... OK
Creating kibana user... OK
Kibana is currently running with legacy OpenSSL providers enabled! For details and instructions on how to disable see https://www.elastic.co/guide/en/kibana/8.19/production.html#openssl-legacy-provider
Created Kibana keystore in /etc/kibana/kibana.keystore
Scanning processes...
Scanning linux images...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo nano /etc/kibana/kibana.yml
specxy@siemserver:~$ sudo systemctl enable kibana
Created symlink /etc/systemd/system/multi-user.target.wants/kibana.service → /usr/lib/systemd/system/kibana.service.
specxy@siemserver:~$ sudo systemctl start kibana
specxy@siemserver:~$ sudo systemctl status kibana
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Mon 2025-08-25 05:31:52 UTC; 7s ago
       Docs: https://www.elastic.co
   Main PID: 3314 (node)
      Tasks: 11 (limit: 4548)
     Memory: 322.6M (peak: 322.8M)
        CPU: 7.522s
     CGroup: /system.slice/kibana.service
             └─3314 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 25 05:31:52 siemserver systemd[1]: Started kibana.service - Kibana.
Aug 25 05:31:52 siemserver kibana[3314]: Kibana is currently running with legacy OpenSSL providers enabled! For details and instructions on how to disable see https://www.elastic.co/guide/en/kibana/8.19/production.html#openssl-legacy-pr>
Aug 25 05:31:53 siemserver kibana[3314]: {"log.level":"info","@timestamp":"2025-08-25T05:31:53.601Z","log.logger":"elastic-apm-node","ecs.version":"8.10.0","agentVersion":"4.13.0","env":{"pid":3314,"proctitle":"/usr/share/kibana/bin/../>
Aug 25 05:31:53 siemserver kibana[3314]: Native global console methods have been overridden in production environment.
Aug 25 05:31:55 siemserver kibana[3314]: [2025-08-25T05:31:55.383+00:00][INFO ][root] Kibana is starting
Aug 25 05:31:55 siemserver kibana[3314]: [2025-08-25T05:31:55.438+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]

specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
05:34:24.128 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-25T05:34:24.126238445Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ sudo chmod 644 /etc/elasticsearch/certs/http_ca.crt
specxy@siemserver:~$ ls -l /etc/elasticsearch/certs/http_ca.crt
ls: cannot access '/etc/elasticsearch/certs/http_ca.crt': Permission denied
specxy@siemserver:~$ sudo ls -l /etc/elasticsearch/certs/http_ca.crt
-rw-r--r-- 1 root elasticsearch 1939 Aug 23 16:30 /etc/elasticsearch/certs/http_ca.crt
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic
05:47:13.314 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-25T05:47:13.312937202Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic
05:50:52.915 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-25T05:50:52.913125911Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ sudo nano /etc/hosts
specxy@siemserver:~$ sudo nano /etc/hosts
specxy@siemserver:~$ specxy@siemserver:~$ sudo nano /etc/hosts
specxy@siemserver:~$ sudo nano /etc/hosts
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic --url https://siemserver:9200
This tool will reset the password of the [elastic] user to an autogenerated value.
The password will be printed in the console.
Please confirm that you would like to continue [y/N]y


Password for the [elastic] user successfully reset.
New value: reQQQM4VRDecK9eCzE_9
specxy@siemserver:~$ curl --cacert /etc/elasticsearch/certs/http_ca.crt -u elastic:reQQQM4VRDecK9eCzE_9 "https://192.168.1.102:9200"
curl: (77) error setting certificate file: /etc/elasticsearch/certs/http_ca.crt
specxy@siemserver:~$ curl --cacert /etc/elasticsearch/certs/http_ca.crt -u elastic:reQQQM4VRDecK9eCzE_9 "https://192.168.1.10:9200"
curl: (7) Failed to connect to 192.168.1.10 port 9200 after 3060 ms: Couldn't connect to server
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic
[sudo] password for specxy:
06:15:15.919 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-25T06:15:15.916947674Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]y

## Do you wish to generate one certificate per node?

If you have multiple nodes in your cluster, then you may choose to generate a
separate certificate for each of these nodes. Each certificate will have its
own private key, and will be issued for a specific hostname or IP address.

Alternatively, you may wish to generate a single certificate that is valid
across all the hostnames or addresses in your cluster.

If all of your nodes will be accessed through a single domain
(e.g. node01.es.example.com, node02.es.example.com, etc) then you may find it
simpler to generate one certificate with a wildcard hostname (*.es.example.com)
and use that across all of your nodes.

However, if you do not have a common domain name, and you expect to add
additional nodes to your cluster in the future, then you should generate a
certificate per node so that you can more easily generate new certificates when
you provision new nodes.

Generate a certificate per node? [y/N]y

## What is the name of node #1?

This name will be used as part of the certificate file name, and as a
descriptive name within the certificate.

You can use any descriptive name that you like, but we recommend using the name
of the Elasticsearch node.

node #1 name: IP:192.168.1.102, DNS:siemserver

## Which hostnames will be used to connect to IP:192.168.1.102, DNS:siemserver?

These hostnames will be added as "DNS" names in the "Subject Alternative Name"
(SAN) field in your certificate.

You should list every hostname and variant that people will use to connect to
your cluster over http.
Do not list IP addresses here, you will be asked to enter them later.

If you wish to use a wildcard certificate (for example *.es.example.com) you
can enter that here.

Enter all the hostnames that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.


You did not enter any hostnames.
Clients are likely to encounter TLS hostname verification errors if they
connect to your cluster using a DNS name.

Is this correct [Y/n]y

## Which IP addresses will be used to connect to IP:192.168.1.102, DNS:siemserver?

If your clients will ever connect to your nodes by numeric IP address, then you
can list these as valid IP "Subject Alternative Name" (SAN) fields in your
certificate.

If you do not have fixed IP addresses, or not wish to support direct IP access
to your cluster then you can just press <ENTER> to skip this step.

Enter all the IP addresses that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.


You did not enter any IP addresses.

Is this correct [Y/n]

## Other certificate options

The generated certificate will have the following additional configuration
values. These values have been selected based on a combination of the
information you have provided above and secure defaults. You should not need to
change these values unless you have specific requirements.

java.lang.IllegalArgumentException: improperly specified input name: CN=IP:192,DC=168,DC=1,DC=102, DNS:siemserver
        at java.base/javax.security.auth.x500.X500Principal.<init>(X500Principal.java:217)
        at java.base/javax.security.auth.x500.X500Principal.<init>(X500Principal.java:158)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.buildDistinguishedName(HttpCertificateCommand.java:794)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.getCertificateConfiguration(HttpCertificateCommand.java:711)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.execute(HttpCertificateCommand.java:205)
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:95)
        at org.elasticsearch.xpack.security.cli.CertificateTool.execute(CertificateTool.java:163)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.Command.main(Command.java:54)
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65)
Caused by: java.io.IOException: Incorrect AVA format
        at java.base/sun.security.x509.AVA.readChar(AVA.java:538)
        at java.base/sun.security.x509.AVA.<init>(AVA.java:173)
        at java.base/sun.security.x509.AVA.<init>(AVA.java:139)
        at java.base/sun.security.x509.RDN.<init>(RDN.java:147)
        at java.base/sun.security.x509.X500Name.parseDN(X500Name.java:939)
        at java.base/sun.security.x509.X500Name.<init>(X500Name.java:161)
        at java.base/javax.security.auth.x500.X500Principal.<init>(X500Principal.java:215)
        ... 11 more
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]y

## Do you wish to generate one certificate per node?

If you have multiple nodes in your cluster, then you may choose to generate a
separate certificate for each of these nodes. Each certificate will have its
own private key, and will be issued for a specific hostname or IP address.

Alternatively, you may wish to generate a single certificate that is valid
across all the hostnames or addresses in your cluster.

If all of your nodes will be accessed through a single domain
(e.g. node01.es.example.com, node02.es.example.com, etc) then you may find it
simpler to generate one certificate with a wildcard hostname (*.es.example.com)
and use that across all of your nodes.

However, if you do not have a common domain name, and you expect to add
additional nodes to your cluster in the future, then you should generate a
certificate per node so that you can more easily generate new certificates when
you provision new nodes.

Generate a certificate per node? [y/N]y

## What is the name of node #1?

This name will be used as part of the certificate file name, and as a
descriptive name within the certificate.

You can use any descriptive name that you like, but we recommend using the name
of the Elasticsearch node.

node #1 name: IP:192.168.1.102, DNS:siemserver

## Which hostnames will be used to connect to IP:192.168.1.102, DNS:siemserver?

These hostnames will be added as "DNS" names in the "Subject Alternative Name"
(SAN) field in your certificate.

You should list every hostname and variant that people will use to connect to
your cluster over http.
Do not list IP addresses here, you will be asked to enter them later.

If you wish to use a wildcard certificate (for example *.es.example.com) you
can enter that here.

Enter all the hostnames that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.


You did not enter any hostnames.
Clients are likely to encounter TLS hostname verification errors if they
connect to your cluster using a DNS name.

Is this correct [Y/n]

## Which IP addresses will be used to connect to IP:192.168.1.102, DNS:siemserver?

If your clients will ever connect to your nodes by numeric IP address, then you
can list these as valid IP "Subject Alternative Name" (SAN) fields in your
certificate.

If you do not have fixed IP addresses, or not wish to support direct IP access
to your cluster then you can just press <ENTER> to skip this step.

Enter all the IP addresses that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.


You did not enter any IP addresses.

Is this correct [Y/n]

## Other certificate options

The generated certificate will have the following additional configuration
values. These values have been selected based on a combination of the
information you have provided above and secure defaults. You should not need to
change these values unless you have specific requirements.

java.lang.IllegalArgumentException: improperly specified input name: CN=IP:192,DC=168,DC=1,DC=102, DNS:siemserver
        at java.base/javax.security.auth.x500.X500Principal.<init>(X500Principal.java:217)
        at java.base/javax.security.auth.x500.X500Principal.<init>(X500Principal.java:158)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.buildDistinguishedName(HttpCertificateCommand.java:794)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.getCertificateConfiguration(HttpCertificateCommand.java:711)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.execute(HttpCertificateCommand.java:205)
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:95)
        at org.elasticsearch.xpack.security.cli.CertificateTool.execute(CertificateTool.java:163)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.Command.main(Command.java:54)
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65)
Caused by: java.io.IOException: Incorrect AVA format
        at java.base/sun.security.x509.AVA.readChar(AVA.java:538)
        at java.base/sun.security.x509.AVA.<init>(AVA.java:173)
        at java.base/sun.security.x509.AVA.<init>(AVA.java:139)
        at java.base/sun.security.x509.RDN.<init>(RDN.java:147)
        at java.base/sun.security.x509.X500Name.parseDN(X500Name.java:939)
        at java.base/sun.security.x509.X500Name.<init>(X500Name.java:161)
        at java.base/javax.security.auth.x500.X500Principal.<init>(X500Principal.java:215)
        ... 11 more
specxy@siemserver:~$
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]y

## Do you wish to generate one certificate per node?

If you have multiple nodes in your cluster, then you may choose to generate a
separate certificate for each of these nodes. Each certificate will have its
own private key, and will be issued for a specific hostname or IP address.

Alternatively, you may wish to generate a single certificate that is valid
across all the hostnames or addresses in your cluster.

If all of your nodes will be accessed through a single domain
(e.g. node01.es.example.com, node02.es.example.com, etc) then you may find it
simpler to generate one certificate with a wildcard hostname (*.es.example.com)
and use that across all of your nodes.

However, if you do not have a common domain name, and you expect to add
additional nodes to your cluster in the future, then you should generate a
certificate per node so that you can more easily generate new certificates when
you provision new nodes.

Generate a certificate per node? [y/N]y

## What is the name of node #1?

This name will be used as part of the certificate file name, and as a
descriptive name within the certificate.

You can use any descriptive name that you like, but we recommend using the name
of the Elasticsearch node.

node #1 name: HTTP TLS certificate chatgpt 25/08/25

## Which hostnames will be used to connect to HTTP TLS certificate chatgpt 25/08/25?

These hostnames will be added as "DNS" names in the "Subject Alternative Name"
(SAN) field in your certificate.

You should list every hostname and variant that people will use to connect to
your cluster over http.
Do not list IP addresses here, you will be asked to enter them later.

If you wish to use a wildcard certificate (for example *.es.example.com) you
can enter that here.

Enter all the hostnames that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.

IP:192.168.1.102, DNS:siemserver

You entered the following hostnames.

 - IP:192.168.1.102, DNS:siemserver

Is this correct [Y/n]y

## Which IP addresses will be used to connect to HTTP TLS certificate chatgpt 25/08/25?

If your clients will ever connect to your nodes by numeric IP address, then you
can list these as valid IP "Subject Alternative Name" (SAN) fields in your
certificate.

If you do not have fixed IP addresses, or not wish to support direct IP access
to your cluster then you can just press <ENTER> to skip this step.

Enter all the IP addresses that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.

IP:192.168.1.102, DNS:siemserver
Error: IP:192.168.1.102, DNS:siemserver is not a valid IP address
IP:192.168.1.102, DNS:192.168.1.1
Error: IP:192.168.1.102, DNS:192.168.1.1 is not a valid IP address
IP:192.168.1.102, DNS:192.168.100.1
Error: IP:192.168.1.102, DNS:192.168.100.1 is not a valid IP address
IP:192.168.1.102, DNS:127.0.0.1
Error: IP:192.168.1.102, DNS:127.0.0.1 is not a valid IP address

You did not enter any IP addresses.

Is this correct [Y/n]y

## Other certificate options

The generated certificate will have the following additional configuration
values. These values have been selected based on a combination of the
information you have provided above and secure defaults. You should not need to
change these values unless you have specific requirements.

Key Name: HTTP TLS certificate chatgpt 25/08/25
Subject DN: CN=HTTP TLS certificate chatgpt 25/08/25
Key Size: 2048
Key Usage: digitalSignature,keyEncipherment

Do you wish to change any of these options? [y/N]y

## What should your key be named?

This will be included in the name of the files that are generated
It is helpful to have a meaningful name for this key

Key Name [HTTP TLS certificate chatgpt 25/08/25] elasticsearch

## What subject DN should be used for your certificate?

This will be visible to clients.
It is helpful to have a meaningful name for each certificate

Subject DN [CN=HTTP TLS certificate chatgpt 25/08/25]

## What key size should your certificate have?

The RSA private key for your certificate has a fixed 'key size' (in bits).
Larger key sizes are generally more secure, but are also slower.

We recommend that you use one of 2048, 3072 or 4096 bits for your key.
Key Size [2048]


## What key usage should your certificate have?

The key usage extension defines the purpose of the key contained in the certificate.
The usage restriction might be employed when a key, that could be used for more than
one operation, is to be restricted.
You may enter the key usage as a comma-delimited list of following values:
 - cRLSign
 - dataEncipherment
 - decipherOnly
 - digitalSignature
 - encipherOnly
 - keyAgreement
 - keyCertSign
 - keyEncipherment
 - nonRepudiation

Key Usage [digitalSignature,keyEncipherment]

Key Name: elasticsearch
Subject DN: CN=HTTP TLS certificate chatgpt 25/08/25
Key Size: 2048
Key Usage: digitalSignature,keyEncipherment

Do you wish to change any of these options? [y/N]y

## What should your key be named?

This will be included in the name of the files that are generated
It is helpful to have a meaningful name for this key

Key Name [elasticsearch]

## What subject DN should be used for your certificate?

This will be visible to clients.
It is helpful to have a meaningful name for each certificate

Subject DN [CN=HTTP TLS certificate chatgpt 25/08/25]

## What key size should your certificate have?

The RSA private key for your certificate has a fixed 'key size' (in bits).
Larger key sizes are generally more secure, but are also slower.

We recommend that you use one of 2048, 3072 or 4096 bits for your key.
Key Size [2048]


## What key usage should your certificate have?

The key usage extension defines the purpose of the key contained in the certificate.
The usage restriction might be employed when a key, that could be used for more than
one operation, is to be restricted.
You may enter the key usage as a comma-delimited list of following values:
 - cRLSign
 - dataEncipherment
 - decipherOnly
 - digitalSignature
 - encipherOnly
 - keyAgreement
 - keyCertSign
 - keyEncipherment
 - nonRepudiation

Key Usage [digitalSignature,keyEncipherment]
jdk.internal.org.jline.reader.UserInterruptException
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:761)
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:512)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$JdkConsoleImpl.readLine(JdkConsoleProviderImpl.java:247)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$LazyDelegatingJdkConsoleImpl.readLine(JdkConsoleProviderImpl.java:118)
        at java.base/java.io.ProxyingConsole.readLine(ProxyingConsole.java:185)
        at java.base/java.io.ProxyingConsole.readLine(ProxyingConsole.java:175)
        at org.elasticsearch.cli.Terminal$ConsoleTerminal.readText(Terminal.java:334)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.tryReadInput(HttpCertificateCommand.java:1177)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.readKeyUsage(HttpCertificateCommand.java:1043)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.getCertificateConfiguration(HttpCertificateCommand.java:770)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.execute(HttpCertificateCommand.java:205)
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:95)
        at org.elasticsearch.xpack.security.cli.CertificateTool.execute(CertificateTool.java:163)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.Command.main(Command.java:54)
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65)
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic --url https://127.0.0.1:9200
This tool will reset the password of the [elastic] user to an autogenerated value.
The password will be printed in the console.
Please confirm that you would like to continue [y/N]y


Password for the [elastic] user successfully reset.
New value: Q-UkXVjXkLcm910RQ=ON
specxy@siemserver:~$ curl --cacert /etc/elasticsearch/certs/http_ca.crt -u elastic:Q-UkXVjXkLcm910RQ=ON  "https://192.168.1.102:9200"
curl: (77) error setting certificate file: /etc/elasticsearch/certs/http_ca.crt
specxy@siemserver:~$ curl --cacert /etc/elasticsearch/certs/http_ca.crt -u elastic:Q-UkXVjXkLcm910RQ=ON  "https://192.168.1.10:9200"
curl: (7) Failed to connect to 192.168.1.10 port 9200 after 3090 ms: Couldn't connect to server
specxy@siemserver:~$ sudo curl --cacert /etc/elasticsearch/certs/http_ca.crt -u elastic:Q-UkXVjXkLcm910RQ=ON  "https://192.168.1.102:9200"
curl: (60) SSL: no alternative certificate subject name matches target host name '192.168.1.102'
More details here: https://curl.se/docs/sslcerts.html

curl failed to verify the legitimacy of the server and therefore could not
establish a secure connection to it. To learn more about this situation and
how to fix it, please visit the web page mentioned above.
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
[sudo] password for specxy:
08:02:46.910 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-25T08:02:46.906626631Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ sudo systemctl status kibana
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Mon 2025-08-25 05:31:52 UTC; 2h 31min ago
       Docs: https://www.elastic.co
   Main PID: 3314 (node)
      Tasks: 11 (limit: 4548)
     Memory: 347.0M (peak: 448.2M)
        CPU: 30.345s
     CGroup: /system.slice/kibana.service
             └─3314 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 25 05:31:53 siemserver kibana[3314]: Native global console methods have been overridden in production environment.
Aug 25 05:31:55 siemserver kibana[3314]: [2025-08-25T05:31:55.383+00:00][INFO ][root] Kibana is starting
Aug 25 05:31:55 siemserver kibana[3314]: [2025-08-25T05:31:55.438+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.627+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.689+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.856+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.877+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.892+00:00][INFO ][root] Holding setup until preboot stage is completed.
Aug 25 05:32:10 siemserver kibana[3314]: i Kibana has not been configured.
Aug 25 05:32:10 siemserver kibana[3314]: Go to http://0.0.0.0:5601/?code=401206 to get started.
lines 1-21/21 (END)
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://127.0.0.1:9200
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJ3MVpFNEpnQm1JNkdyeml0LTVCQTo0TzNCS08td21qT1pIcmZVaXFpYU5RIn0=
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJ3MVpFNEpnQm1JNkdyeml0LTVCQTo0TzNCS08td21qT1pIcmZVaXFpYU5RIn0=
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: Hostname/IP does not match certificate's altnames: IP: 192.168.1.102 is not in the cert's list: fe80::20c:29ff:fe00:ab1f, 192.168.1.101, ::1, 127.0.0.1

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ sudo nano /etc/hosts
specxy@siemserver:~$ specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://127.0.0.1:9200
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJ4VlpSNEpnQm1JNkdyeml0dTVDNTpZY000M3VCSmg2ejB2d0ctNXhXTC1BIn0=
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJ4VlpSNEpnQm1JNkdyeml0dTVDNTpZY000M3VCSmg2ejB2d0ctNXhXTC1BIn0= --url https://siemserver:9200
Native global console methods have been overridden in production environment.
error: unknown option '--url'
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://127.0.0.1:9200
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJ4MVpUNEpnQm1JNkdyeml0ZjVEXzpmTTNLRHdEQVlVYXhFWm1Vc0RvRTZnIn0=
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup \
    --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJ4MVpUNEpnQm1JNkdyeml0ZjVEXzpmTTNLRHdEQVlVYXhFWm1Vc0RvRTZnIn0= \
    --url https://127.0.0.1:9200
Native global console methods have been overridden in production environment.
error: unknown option '--url'
specxy@siemserver:~$ sudo systemctl stop elasticsearch
specxy@siemserver:~$ sudo systemctl status elasticsearch
○ elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: inactive (dead) since Mon 2025-08-25 08:35:54 UTC; 8s ago
   Duration: 4h 3min 37.183s
       Docs: https://www.elastic.co
    Process: 2713 ExecStart=/usr/share/elasticsearch/bin/systemd-entrypoint -p ${PID_DIR}/elasticsearch.pid --quiet (code=exited, status=143)
   Main PID: 2713 (code=exited, status=143)
        CPU: 5min 59.174s

Aug 25 04:31:57 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 25 04:32:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.
Aug 25 08:35:54 siemserver systemd[1]: Stopping elasticsearch.service - Elasticsearch...
Aug 25 08:35:54 siemserver systemd[1]: elasticsearch.service: Deactivated successfully.
Aug 25 08:35:54 siemserver systemd[1]: Stopped elasticsearch.service - Elasticsearch.
Aug 25 08:35:54 siemserver systemd[1]: elasticsearch.service: Consumed 5min 59.174s CPU time, 2.3G memory peak, 201.5M memory swap peak.
specxy@siemserver:~$ ^C
specxy@siemserver:~$
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]y

## Do you wish to generate one certificate per node?

If you have multiple nodes in your cluster, then you may choose to generate a
separate certificate for each of these nodes. Each certificate will have its
own private key, and will be issued for a specific hostname or IP address.

Alternatively, you may wish to generate a single certificate that is valid
across all the hostnames or addresses in your cluster.

If all of your nodes will be accessed through a single domain
(e.g. node01.es.example.com, node02.es.example.com, etc) then you may find it
simpler to generate one certificate with a wildcard hostname (*.es.example.com)
and use that across all of your nodes.

However, if you do not have a common domain name, and you expect to add
additional nodes to your cluster in the future, then you should generate a
certificate per node so that you can more easily generate new certificates when
you provision new nodes.

Generate a certificate per node? [y/N]y

## What is the name of node #1?

This name will be used as part of the certificate file name, and as a
descriptive name within the certificate.

You can use any descriptive name that you like, but we recommend using the name
of the Elasticsearch node.

node #1 name: instant-001

## Which hostnames will be used to connect to instant-001?

These hostnames will be added as "DNS" names in the "Subject Alternative Name"
(SAN) field in your certificate.

You should list every hostname and variant that people will use to connect to
your cluster over http.
Do not list IP addresses here, you will be asked to enter them later.

If you wish to use a wildcard certificate (for example *.es.example.com) you
can enter that here.

Enter all the hostnames that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.

IP:192.168.1.102, IP:192.168.1.101

You entered the following hostnames.

 - IP:192.168.1.102, IP:192.168.1.101

Is this correct [Y/n]y

## Which IP addresses will be used to connect to instant-001?

If your clients will ever connect to your nodes by numeric IP address, then you
can list these as valid IP "Subject Alternative Name" (SAN) fields in your
certificate.

If you do not have fixed IP addresses, or not wish to support direct IP access
to your cluster then you can just press <ENTER> to skip this step.

Enter all the IP addresses that you need, one per line.
When you are done, press <ENTER> once more to move on to the next step.


You did not enter any IP addresses.

Is this correct [Y/n]y

## Other certificate options

The generated certificate will have the following additional configuration
values. These values have been selected based on a combination of the
information you have provided above and secure defaults. You should not need to
change these values unless you have specific requirements.

Key Name: instant-001
Subject DN: CN=instant-001
Key Size: 2048
Key Usage: digitalSignature,keyEncipherment

Do you wish to change any of these options? [y/N]N
Generate additional certificates? [Y/n]n

## What password do you want for your private key(s)?

Your private key(s) will be stored as a PEM formatted file.
We recommend that you protect your private keys with a password

If you do not wish to use a password, simply press <enter> at the prompt below.
Provide a password for the private key:  [<ENTER> for none]
Repeat password to confirm:

## Where should we save the generated files?

A number of files will be generated including your private key(s),
certificate request(s), and sample configuration options for Elastic Stack products.

These files will be included in a single zip archive.

What filename should be used for the output zip file? [/usr/share/elasticsearch/elasticsearch-ssl-http.zip]

Zip file written to /usr/share/elasticsearch/elasticsearch-ssl-http.zip
specxy@siemserver:~$ cd /usr/share/elasticsearch/
specxy@siemserver:/usr/share/elasticsearch$ ls
bin  elasticsearch-ssl-http.zip  jdk  lib  modules  NOTICE.txt  plugins  README.asciidoc
specxy@siemserver:/usr/share/elasticsearch$ unzip elasticsearch-ssl-http.zip
Command 'unzip' not found, but can be installed with:
sudo apt install unzip
specxy@siemserver:/usr/share/elasticsearch$ sudo apt install unzip
[sudo] password for specxy:
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Suggested packages:
  zip
The following NEW packages will be installed:
  unzip
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 174 kB of archives.
After this operation, 384 kB of additional disk space will be used.
Get:1 http://lk.archive.ubuntu.com/ubuntu noble-updates/main amd64 unzip amd64 6.0-28ubuntu4.1 [174 kB]
Fetched 174 kB in 3s (62.4 kB/s)
Selecting previously unselected package unzip.
(Reading database ... 215612 files and directories currently installed.)
Preparing to unpack .../unzip_6.0-28ubuntu4.1_amd64.deb ...
Unpacking unzip (6.0-28ubuntu4.1) ...
Setting up unzip (6.0-28ubuntu4.1) ...
Processing triggers for man-db (2.12.0-4build2) ...
Scanning processes...
Scanning linux images...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
specxy@siemserver:/usr/share/elasticsearch$ unzip elasticsearch-ssl-http.zip
error:  cannot open zipfile [ elasticsearch-ssl-http.zip ]
        Permission denied
unzip:  cannot find or open elasticsearch-ssl-http.zip, elasticsearch-ssl-http.zip.zip or elasticsearch-ssl-http.zip.ZIP.
specxy@siemserver:/usr/share/elasticsearch$ sudo unzip elasticsearch-ssl-http.zip
Archive:  elasticsearch-ssl-http.zip
   creating: elasticsearch/
  inflating: elasticsearch/README.txt
  inflating: elasticsearch/http-instant-001.csr
  inflating: elasticsearch/http-instant-001.key
  inflating: elasticsearch/sample-elasticsearch.yml
   creating: kibana/
  inflating: kibana/README.txt
  inflating: kibana/sample-kibana.yml
specxy@siemserver:/usr/share/elasticsearch$ ls
bin  elasticsearch  elasticsearch-ssl-http.zip  jdk  kibana  lib  modules  NOTICE.txt  plugins  README.asciidoc
specxy@siemserver:/usr/share/elasticsearch$ cd elasticsearch/
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ ls
http-instant-001.csr  http-instant-001.key  README.txt  sample-elasticsearch.yml
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ cd /etc/elasticsearch/certs/
-bash: cd: /etc/elasticsearch/certs/: Permission denied
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ sudo cd /etc/elasticsearch/certs/
sudo: cd: command not found
sudo: "cd" is a shell built-in command, it cannot be run directly.
sudo: the -s option may be used to run a privileged shell.
sudo: the -D option may be used to run a command in a specific directory.
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ cd ~
specxy@siemserver:~$ cd /etc/elasticsearch/certs
-bash: cd: /etc/elasticsearch/certs: Permission denied
specxy@siemserver:~$ sudo cd /etc/elasticsearch/
sudo: cd: command not found
sudo: "cd" is a shell built-in command, it cannot be run directly.
sudo: the -s option may be used to run a privileged shell.
sudo: the -D option may be used to run a command in a specific directory.
specxy@siemserver:~$ cd /etc/elasticsearch/
-bash: cd: /etc/elasticsearch/: Permission denied
specxy@siemserver:~$ sudo -s cd /etc/elasticsearch/certs
specxy@siemserver:~$ ls
apt  sudo  update
specxy@siemserver:~$ pwd
/home/specxy
specxy@siemserver:~$ cd /usr/share/elasticsearch/
specxy@siemserver:/usr/share/elasticsearch$ ls
bin  elasticsearch  elasticsearch-ssl-http.zip  jdk  kibana  lib  modules  NOTICE.txt  plugins  README.asciidoc
specxy@siemserver:/usr/share/elasticsearch$ cd elasticsearch/
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ ls
http-instant-001.csr  http-instant-001.key  README.txt  sample-elasticsearch.yml
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ ls -la
total 24
drwxr-xr-x 2 root root 4096 Aug 25 08:46 .
drwxr-xr-x 9 root root 4096 Aug 25 08:54 ..
-rw-r--r-- 1 root root 1029 Aug 25 08:46 http-instant-001.csr
-rw-r--r-- 1 root root 1766 Aug 25 08:46 http-instant-001.key
-rw-r--r-- 1 root root 2728 Aug 25 08:46 README.txt
-rw-r--r-- 1 root root 1371 Aug 25 08:46 sample-elasticsearch.yml
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ cd ..
specxy@siemserver:/usr/share/elasticsearch$ ls -la
total 2336
drwxr-xr-x   9 root root    4096 Aug 25 08:54 .
drwxr-xr-x 141 root root    4096 Aug 25 05:19 ..
drwxr-xr-x   2 root root    4096 Aug 23 16:30 bin
drwxr-xr-x   2 root root    4096 Aug 25 08:46 elasticsearch
-rw-------   1 root root    6139 Aug 25 08:46 elasticsearch-ssl-http.zip
drwxr-xr-x   9 root root    4096 Aug 23 16:30 jdk
drwxr-xr-x   2 root root    4096 Aug 25 08:46 kibana
drwxr-xr-x   8 root root    4096 Aug 23 16:30 lib
drwxr-xr-x  92 root root    4096 Aug 23 16:30 modules
-rw-r--r--   1 root root 2331746 Aug 11 10:09 NOTICE.txt
drwxr-xr-x   2 root root    4096 Aug 11 10:15 plugins
-rw-r--r--   1 root root   10119 Aug 11 10:07 README.asciidoc
specxy@siemserver:/usr/share/elasticsearch$ cd elasticsearch/
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ cd ~
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo systemctl status elasticsearch
[sudo] password for specxy:
○ elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: inactive (dead) since Mon 2025-08-25 08:35:54 UTC; 55min ago
   Duration: 4h 3min 37.183s
       Docs: https://www.elastic.co
    Process: 2713 ExecStart=/usr/share/elasticsearch/bin/systemd-entrypoint -p ${PID_DIR}/elasticsearch.pid --quiet (code=exited, status=143)
   Main PID: 2713 (code=exited, status=143)
        CPU: 5min 59.174s

Aug 25 04:31:57 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 25 04:32:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.
Aug 25 08:35:54 siemserver systemd[1]: Stopping elasticsearch.service - Elasticsearch...
Aug 25 08:35:54 siemserver systemd[1]: elasticsearch.service: Deactivated successfully.
Aug 25 08:35:54 siemserver systemd[1]: Stopped elasticsearch.service - Elasticsearch.
Aug 25 08:35:54 siemserver systemd[1]: elasticsearch.service: Consumed 5min 59.174s CPU time, 2.3G memory peak, 201.5M memory swap peak.
specxy@siemserver:~$ sudo systemctl start elasticsearch
specxy@siemserver:~$ sudo systemctl status elasticsearch
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Mon 2025-08-25 09:32:09 UTC; 4s ago
       Docs: https://www.elastic.co
   Main PID: 4764 (java)
      Tasks: 100 (limit: 4548)
     Memory: 2.4G (peak: 2.4G)
        CPU: 30.460s
     CGroup: /system.slice/elasticsearch.service
             ├─4764 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home=/usr/share/elasticsearch >
             ├─4830 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djna.nosys=true -XX:-OmitSta>
             └─4855 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 25 09:31:48 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 25 09:32:09 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.

specxy@siemserver:~$ sudo systemctl status kibana.service
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Mon 2025-08-25 05:31:52 UTC; 4h 0min ago
       Docs: https://www.elastic.co
   Main PID: 3314 (node)
      Tasks: 11 (limit: 4548)
     Memory: 346.8M (peak: 448.2M)
        CPU: 39.969s
     CGroup: /system.slice/kibana.service
             └─3314 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 25 05:31:53 siemserver kibana[3314]: Native global console methods have been overridden in production environment.
Aug 25 05:31:55 siemserver kibana[3314]: [2025-08-25T05:31:55.383+00:00][INFO ][root] Kibana is starting
Aug 25 05:31:55 siemserver kibana[3314]: [2025-08-25T05:31:55.438+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.627+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.689+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.856+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.877+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 25 05:32:03 siemserver kibana[3314]: [2025-08-25T05:32:03.892+00:00][INFO ][root] Holding setup until preboot stage is completed.
Aug 25 05:32:10 siemserver kibana[3314]: i Kibana has not been configured.
Aug 25 05:32:10 siemserver kibana[3314]: Go to http://0.0.0.0:5601/?code=401206 to get started.

specxy@siemserver:~$ sudo nano /etc/hosts
[sudo] password for specxy:
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
[sudo] password for specxy:
11:00:35.931 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-25T11:00:35.929239469Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://siemserver:9200
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJmcFhqNEpnQnduMEh2aTc4b3VQUTpPUjFyY2xwYV9lODJXbU9zMDE0VEFRIn0=
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMjo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJmcFhqNEpnQnduMEh2aTc4b3VQUTpPUjFyY2xwYV9lODJXbU9zMDE0VEFRIn0=
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: Hostname/IP does not match certificate's altnames: IP: 192.168.1.102 is not in the cert's list: fe80::20c:29ff:fe00:ab1f, 192.168.1.101, ::1, 127.0.0.1

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http
[sudo] password for specxy:

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]N

## Do you have an existing Certificate Authority (CA) key-pair that you wish to use to sign your certificate?

If you have an existing CA certificate and key, then you can use that CA to
sign your new http certificate. This allows you to use the same CA across
multiple Elasticsearch clusters which can make it easier to configure clients,
and may be easier for you to manage.

If you do not have an existing CA, one will be generated for you.

Use an existing CA? [y/N]y

## What is the path to your CA?

Please enter the full pathname to the Certificate Authority that you wish to
use for signing your new http certificate. This can be in PKCS#12 (.p12), JKS
(.jks) or PEM (.crt, .key, .pem) format.
CA Path: /etc/elasticsearch/certs/elastic-stack-ca.p12
The file /etc/elasticsearch/certs/elastic-stack-ca.p12 does not exist
CA Path:
jdk.internal.org.jline.reader.UserInterruptException
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:761)
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:512)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$JdkConsoleImpl.readLine(JdkConsoleProviderImpl.java:247)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$LazyDelegatingJdkConsoleImpl.readLine(JdkConsoleProviderImpl.java:118)
        at java.base/java.io.ProxyingConsole.readLine(ProxyingConsole.java:185)
        at java.base/java.io.ProxyingConsole.readLine(ProxyingConsole.java:175)
        at org.elasticsearch.cli.Terminal$ConsoleTerminal.readText(Terminal.java:334)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.requestPath(HttpCertificateCommand.java:1210)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.findExistingCA(HttpCertificateCommand.java:844)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.execute(HttpCertificateCommand.java:186)
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:95)
        at org.elasticsearch.xpack.security.cli.CertificateTool.execute(CertificateTool.java:163)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.Command.main(Command.java:54)
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65)
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]N

## Do you have an existing Certificate Authority (CA) key-pair that you wish to use to sign your certificate?

If you have an existing CA certificate and key, then you can use that CA to
sign your new http certificate. This allows you to use the same CA across
multiple Elasticsearch clusters which can make it easier to configure clients,
and may be easier for you to manage.

If you do not have an existing CA, one will be generated for you.

Use an existing CA? [y/N]N
A new Certificate Authority will be generated for you

## CA Generation Options

The generated certificate authority will have the following configuration values.
These values have been selected based on secure defaults.
You should not need to change these values unless you have specific requirements.

Subject DN: CN=Elasticsearch HTTP CA
Validity: 5y
Key Size: 2048
Key Usage: keyCertSign,cRLSign

Do you wish to change any of these options? [y/N]
jdk.internal.org.jline.reader.UserInterruptException
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:761)
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:512)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$JdkConsoleImpl.readLine(JdkConsoleProviderImpl.java:247)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$LazyDelegatingJdkConsoleImpl.readLine(JdkConsoleProviderImpl.java:118)
        at java.base/java.io.ProxyingConsole.readLine(ProxyingConsole.java:185)
        at java.base/java.io.ProxyingConsole.readLine(ProxyingConsole.java:175)
        at org.elasticsearch.cli.Terminal$ConsoleTerminal.readText(Terminal.java:334)
        at org.elasticsearch.cli.Terminal.promptYesNo(Terminal.java:231)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.createNewCA(HttpCertificateCommand.java:902)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.execute(HttpCertificateCommand.java:188)
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:95)
        at org.elasticsearch.xpack.security.cli.CertificateTool.execute(CertificateTool.java:163)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.Command.main(Command.java:54)
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65)
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]N

## Do you have an existing Certificate Authority (CA) key-pair that you wish to use to sign your certificate?

If you have an existing CA certificate and key, then you can use that CA to
sign your new http certificate. This allows you to use the same CA across
multiple Elasticsearch clusters which can make it easier to configure clients,
and may be easier for you to manage.

If you do not have an existing CA, one will be generated for you.

Use an existing CA? [y/N]y

## What is the path to your CA?

Please enter the full pathname to the Certificate Authority that you wish to
use for signing your new http certificate. This can be in PKCS#12 (.p12), JKS
(.jks) or PEM (.crt, .key, .pem) format.
CA Path:
Failed to read from file /etc/elasticsearch
java.io.IOException: Is a directory
The file at /etc/elasticsearch isn't a file type that this tool recognises.
Please try again with a CA in PKCS#12, JKS or PEM format

ERROR: /etc/elasticsearch: Unrecognized file type, with exit code 65
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http
[sudo] password for specxy:

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]N

## Do you have an existing Certificate Authority (CA) key-pair that you wish to use to sign your certificate?

If you have an existing CA certificate and key, then you can use that CA to
sign your new http certificate. This allows you to use the same CA across
multiple Elasticsearch clusters which can make it easier to configure clients,
and may be easier for you to manage.

If you do not have an existing CA, one will be generated for you.

Use an existing CA? [y/N]N
A new Certificate Authority will be generated for you

## CA Generation Options

The generated certificate authority will have the following configuration values.
These values have been selected based on secure defaults.
You should not need to change these values unless you have specific requirements.

Subject DN: CN=Elasticsearch HTTP CA
Validity: 5y
Key Size: 2048
Key Usage: keyCertSign,cRLSign

Do you wish to change any of these options? [y/N]N

## CA password

We recommend that you protect your CA private key with a strong password.
If your key does not have a password (or the password can be easily guessed)
then anyone who gets a copy of the key file will be able to generate new certificates
and impersonate your Elasticsearch cluster.

IT IS IMPORTANT THAT YOU REMEMBER THIS PASSWORD AND KEEP IT SECURE

CA password:  [<ENTER> for none]
jdk.internal.org.jline.reader.UserInterruptException
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:761)
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:553)
        at jdk.internal.le/jdk.internal.org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl.java:524)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$JdkConsoleImpl.readPassword(JdkConsoleProviderImpl.java:267)
        at jdk.internal.le/jdk.internal.org.jline.JdkConsoleProviderImpl$LazyDelegatingJdkConsoleImpl.readPassword(JdkConsoleProviderImpl.java:128)
        at java.base/java.io.ProxyingConsole.readPassword(ProxyingConsole.java:215)
        at java.base/java.io.ProxyingConsole.readPassword(ProxyingConsole.java:205)
        at org.elasticsearch.cli.Terminal$ConsoleTerminal.readSecret(Terminal.java:339)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.readPassword(HttpCertificateCommand.java:1069)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.createNewCA(HttpCertificateCommand.java:983)
        at org.elasticsearch.xpack.security.cli.HttpCertificateCommand.execute(HttpCertificateCommand.java:188)
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:95)
        at org.elasticsearch.xpack.security.cli.CertificateTool.execute(CertificateTool.java:163)
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101)
        at org.elasticsearch.cli.Command.main(Command.java:54)
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65)
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil http
[sudo] password for specxy:

## Elasticsearch HTTP Certificate Utility

The 'http' command guides you through the process of generating certificates
for use on the HTTP (Rest) interface for Elasticsearch.

This tool will ask you a number of questions in order to generate the right
set of files for your needs.

## Do you wish to generate a Certificate Signing Request (CSR)?

A CSR is used when you want your certificate to be created by an existing
Certificate Authority (CA) that you do not control (that is, you don't have
access to the keys for that CA).

If you are in a corporate environment with a central security team, then you
may have an existing Corporate CA that can generate your certificate for you.
Infrastructure within your organisation may already be configured to trust this
CA, so it may be easier for clients to connect to Elasticsearch if you use a
CSR and send that request to the team that controls your CA.

If you choose not to generate a CSR, this tool will generate a new certificate
for you. That certificate will be signed by a CA under your control. This is a
quick and easy way to secure your cluster with TLS, but you will need to
configure all your clients to trust that custom CA.

Generate a CSR? [y/N]N

## Do you have an existing Certificate Authority (CA) key-pair that you wish to use to sign your certificate?

If you have an existing CA certificate and key, then you can use that CA to
sign your new http certificate. This allows you to use the same CA across
multiple Elasticsearch clusters which can make it easier to configure clients,
and may be easier for you to manage.

If you do not have an existing CA, one will be generated for you.

Use an existing CA? [y/N]y

## What is the path to your CA?

Please enter the full pathname to the Certificate Authority that you wish to
use for signing your new http certificate. This can be in PKCS#12 (.p12), JKS
(.jks) or PEM (.crt, .key, .pem) format.
CA Path: /usr/share/elasticsearch/elastic-stack-ca.p12
The file /usr/share/elasticsearch/elastic-stack-ca.p12 does not exist
CA Path: client_loop: send disconnect: Connection reset

C:\Windows\System32>ip a
'ip' is not recognized as an internal or external command,
operable program or batch file.

C:\Windows\System32>ssh specxy@192.168.1.102
specxy@192.168.1.102's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Aug 26 03:05:31 AM UTC 2025

  System load:  0.03               Processes:              270
  Usage of /:   51.4% of 18.53GB   Users logged in:        1
  Memory usage: 78%                IPv4 address for ens33: 192.168.1.102
  Swap usage:   4%                 IPv4 address for ens33: 192.168.242.128


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Mon Aug 25 11:42:06 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.102/24 brd 192.168.1.255 scope global dynamic ens33
       valid_lft 5639sec preferred_lft 5639sec
    inet 192.168.242.128/24 metric 100 brd 192.168.242.255 scope global dynamic ens33
       valid_lft 1265sec preferred_lft 1265sec
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=127 time=78.1 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=127 time=89.4 ms
^C
--- 8.8.8.8 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 78.071/83.718/89.365/5.647 ms
specxy@siemserver:~$ traceroute 8.8.8.8
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  pfSense.home.arpa (192.168.1.1)  1.164 ms  1.181 ms  1.375 ms
 2  192.168.25.2 (192.168.25.2)  3.105 ms  3.074 ms  3.325 ms
 3  * * *
 4  * * *
 5  * * *
 6  * * *
 7  * * *
 8  *^C
specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ipconfig

Windows IP Configuration


Wireless LAN adapter Wi-Fi 4:

   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . :

Wireless LAN adapter Wi-Fi 5:

   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . :

Ethernet adapter VMware Network Adapter VMnet1:

   Connection-specific DNS Suffix  . :
   Link-local IPv6 Address . . . . . : fe80::d5aa:b160:5a84:40b4%32
   IPv4 Address. . . . . . . . . . . : 192.168.1.3
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : fe80::20c:29ff:fee2:9201%32

Ethernet adapter VMware Network Adapter VMnet8:

   Connection-specific DNS Suffix  . :
   Link-local IPv6 Address . . . . . : fe80::f24:b6a1:9291:9e77%39
   IPv4 Address. . . . . . . . . . . : 192.168.25.1
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . :

Wireless LAN adapter Wi-Fi:

   Connection-specific DNS Suffix  . :
   Link-local IPv6 Address . . . . . : fe80::94ee:518a:5ec5:7423%20
   IPv4 Address. . . . . . . . . . . : 192.168.1.43
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : 192.168.1.1

C:\Windows\System32>ping 192.168.1.1

Pinging 192.168.1.1 with 32 bytes of data:
Reply from 192.168.1.1: bytes=32 time<1ms TTL=64
Reply from 192.168.1.1: bytes=32 time=1ms TTL=64

Ping statistics for 192.168.1.1:
    Packets: Sent = 2, Received = 2, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 1ms, Average = 0ms
Control-C
^C
C:\Windows\System32>ssh specxy@192.168.1.102
specxy@192.168.1.102's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Aug 26 03:42:19 AM UTC 2025

  System load:  0.03               Processes:              309
  Usage of /:   51.5% of 18.53GB   Users logged in:        1
  Memory usage: 68%                IPv4 address for ens33: 192.168.1.102
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Tue Aug 26 03:06:53 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
[sudo] password for specxy:
03:54:03.656 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-26T03:54:03.654197869Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://siemserver:9200
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlB3LUc1SmdCOVhGRkhEU3U4NVE2Ojh2MUFDVXRIU1V2WFhFZklDdDhCVHcifQ==
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlB3LUc1SmdCOVhGRkhEU3U4NVE2Ojh2MUFDVXRIU1V2WFhFZklDdDhCVHcifQ== --url https://siemserver:9200
[sudo] password for specxy:
Native global console methods have been overridden in production environment.
error: unknown option '--url'
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlB3LUc1SmdCOVhGRkhEU3U4NVE2Ojh2MUFDVXRIU1V2WFhFZklDdDhCVHcifQ==
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: {"error":{"root_cause":[{"type":"security_exception","reason":"unable to authenticate with provided credentials and anonymous access is not allowed for this request","additional_unsuccessful_credentials":"API key: api key is expired","header":{"WWW-Authenticate":["Basic realm=\"security\", charset=\"UTF-8\"","Bearer realm=\"security\"","ApiKey"]}}],"type":"security_exception","reason":"unable to authenticate with provided credentials and anonymous access is not allowed for this request","additional_unsuccessful_credentials":"API key: api key is expired","header":{"WWW-Authenticate":["Basic realm=\"security\", charset=\"UTF-8\"","Bearer realm=\"security\"","ApiKey"]}},"status":401}

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://siemserver:9200
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlFRLXI1SmdCOVhGRkhEU3UxNVRvOjdSQkVJSlVveFlyUFVmUkxGQ0lRWncifQ==
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlFRLXI1SmdCOVhGRkhEU3UxNVRvOjdSQkVJSlVveFlyUFVmUkxGQ0lRWncifQ==
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: Hostname/IP does not match certificate's altnames: IP: 192.168.242.128 is not in the cert's list: fe80::20c:29ff:fe00:ab1f, 192.168.1.101, ::1, 127.0.0.1

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.102/24 brd 192.168.1.255 scope global dynamic ens33
       valid_lft 6809sec preferred_lft 6809sec
    inet 192.168.242.128/24 metric 100 brd 192.168.242.255 scope global dynamic ens33
       valid_lft 1551sec preferred_lft 1551sec
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://siemserver:9200
[sudo] password for specxy:
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlF3X1E1SmdCOVhGRkhEU3VJSlNhOkwyc21nREpLZmlDSC1jYUV1TXp0NGcifQ==
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlF3X1E1SmdCOVhGRkhEU3VJSlNhOkwyc21nREpLZmlDSC1jYUV1TXp0NGcifQ==
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: Hostname/IP does not match certificate's altnames: IP: 192.168.242.128 is not in the cert's list: fe80::20c:29ff:fe00:ab1f, 192.168.1.101, ::1, 127.0.0.1

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ ^C
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.102/24 brd 192.168.1.255 scope global dynamic ens33
       valid_lft 6530sec preferred_lft 6530sec
    inet 192.168.242.128/24 metric 100 brd 192.168.242.255 scope global dynamic ens33
       valid_lft 1747sec preferred_lft 1747sec
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ exit
logout
Connection to 192.168.1.102 closed.

C:\Windows\System32>ssh specxy@192.168.1.102
specxy@192.168.1.102's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Aug 26 05:33:57 AM UTC 2025

  System load:  0.03               Processes:              314
  Usage of /:   51.5% of 18.53GB   Users logged in:        1
  Memory usage: 69%                IPv4 address for ens33: 192.168.1.102
  Swap usage:   0%                 IPv4 address for ens33: 192.168.242.128


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Tue Aug 26 03:42:42 2025 from 192.168.1.3
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
[sudo] password for specxy:
05:56:26.325 [main] WARN  org.elasticsearch.common.ssl.DiagnosticTrustManager - failed to establish trust with server at [192.168.1.102]; the server provided a certificate with subject name [CN=siemserver], fingerprint [95792f5a4d603ffc963392b2a3d6a5803c4905d9], keyUsage [digitalSignature, keyEncipherment] and extendedKeyUsage [serverAuth]; the certificate is valid between [2025-08-23T16:30:43Z] and [2027-08-23T16:30:43Z] (current time is [2025-08-26T05:56:26.323518803Z], certificate dates are valid); the session uses cipher suite [TLS_AES_256_GCM_SHA384] and protocol [TLSv1.3]; the certificate has subject alternative names [IP:fe80:0:0:0:20c:29ff:fe00:ab1f,IP:192.168.1.101,IP:0:0:0:0:0:0:0:1,IP:127.0.0.1,DNS:localhost,DNS:siemserver]; the certificate is issued by [CN=Elasticsearch security auto-configuration HTTP CA]; the certificate is signed by (subject [CN=Elasticsearch security auto-configuration HTTP CA] fingerprint [2a24a66f78d0f7a1e130242be4baee7d287617d8] {trusted issuer}) which is self-issued; the [CN=Elasticsearch security auto-configuration HTTP CA] certificate is trusted in this ssl context ([xpack.security.http.ssl (with trust configuration: Composite-Trust{JDK-trusted-certs,StoreTrustConfig{path=certs/http.p12, password=<non-empty>, type=PKCS12, algorithm=PKIX}})])
java.security.cert.CertificateException: No subject alternative names matching IP address 192.168.1.102 found
        at sun.security.util.HostnameChecker.matchIP(HostnameChecker.java:160) ~[?:?]
        at sun.security.util.HostnameChecker.match(HostnameChecker.java:101) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:466) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(X509TrustManagerImpl.java:432) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:237) ~[?:?]
        at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:132) ~[?:?]
        at org.elasticsearch.common.ssl.DiagnosticTrustManager.checkServerTrusted(DiagnosticTrustManager.java:81) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.checkServerCerts(CertificateMessage.java:1310) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.onConsumeCertificate(CertificateMessage.java:1203) ~[?:?]
        at sun.security.ssl.CertificateMessage$T13CertificateConsumer.consume(CertificateMessage.java:1146) ~[?:?]
        at sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476) ~[?:?]
        at sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447) ~[?:?]
        at sun.security.ssl.TransportContext.dispatch(TransportContext.java:199) ~[?:?]
        at sun.security.ssl.SSLTransport.decode(SSLTransport.java:172) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455) ~[?:?]
        at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426) ~[?:?]
        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:482) ~[?:?]
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:187) ~[?:?]
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:141) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.lambda$doPrivileged$0(SocketAccess.java:42) ~[?:?]
        at java.security.AccessController.doPrivileged(AccessController.java:251) ~[?:?]
        at org.elasticsearch.xpack.core.common.socket.SocketAccess.doPrivileged(SocketAccess.java:41) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:178) ~[?:?]
        at org.elasticsearch.xpack.core.security.CommandLineHttpClient.execute(CommandLineHttpClient.java:112) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.checkClusterHealthWithRetries(BaseRunAsSuperuserCommand.java:214) ~[?:?]
        at org.elasticsearch.xpack.security.tool.BaseRunAsSuperuserCommand.execute(BaseRunAsSuperuserCommand.java:127) ~[?:?]
        at org.elasticsearch.common.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:55) ~[elasticsearch-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:101) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.cli.Command.main(Command.java:54) ~[elasticsearch-cli-8.19.2.jar:8.19.2]
        at org.elasticsearch.launcher.CliToolLauncher.main(CliToolLauncher.java:65) ~[cli-launcher-8.19.2.jar:8.19.2]

ERROR: Failed to determine the health of the cluster., with exit code 69
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.102/24 brd 192.168.1.255 scope global dynamic ens33
       valid_lft 7196sec preferred_lft 7196sec
    inet 192.168.242.128/24 metric 100 brd 192.168.242.255 scope global dynamic ens33
       valid_lft 1799sec preferred_lft 1799sec
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ ls /etc/netplan/
50-cloud-init.yaml


specxy@siemserver:~$ ls /etc/netplan/
50-cloud-init.yaml
specxy@siemserver:~$ sudo nano /etc/netplan/50-cloud-init.yaml
specxy@siemserver:~$ sudo netplan apply

** (generate:3602): WARNING **: 06:26:19.774: `gateway4` has been deprecated, use default routes instead.
See the 'Default routes' section of the documentation for more details.

** (process:3600): WARNING **: 06:26:20.211: `gateway4` has been deprecated, use default routes instead.
See the 'Default routes' section of the documentation for more details.

** (process:3600): WARNING **: 06:26:20.359: `gateway4` has been deprecated, use default routes instead.
See the 'Default routes' section of the documentation for more details.
client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.102

C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Aug 26 06:27:00 AM UTC 2025

  System load:  0.05               Processes:              317
  Usage of /:   51.5% of 18.53GB   Users logged in:        1
  Memory usage: 69%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Tue Aug 26 05:35:12 2025 from 192.168.1.3
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ sudo systemctl status kibana
[sudo] password for specxy:
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 03:32:50 UTC; 2h 54min ago
       Docs: https://www.elastic.co
   Main PID: 1384 (node)
      Tasks: 11 (limit: 7564)
     Memory: 492.2M (peak: 656.5M)
        CPU: 39.924s
     CGroup: /system.slice/kibana.service
             └─1384 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 26 03:32:54 siemserver kibana[1384]: Native global console methods have been overridden in production environment.
Aug 26 03:32:58 siemserver kibana[1384]: [2025-08-26T03:32:58.066+00:00][INFO ][root] Kibana is starting
Aug 26 03:32:58 siemserver kibana[1384]: [2025-08-26T03:32:58.119+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.262+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.357+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.576+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.610+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.645+00:00][INFO ][root] Holding setup until preboot stage is completed.
Aug 26 03:33:23 siemserver kibana[1384]: i Kibana has not been configured.
Aug 26 03:33:23 siemserver kibana[1384]: Go to http://0.0.0.0:5601/?code=807062 to get started.
lines 1-21/21 (END)
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlJROFA1WmdCOVhGRkhEU3UwcFI0OlRSVnJZdlR4bTVKWG9sYVpNalJvSlEifQ==
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlJROFA1WmdCOVhGRkhEU3UwcFI0OlRSVnJZdlR4bTVKWG9sYVpNalJvSlEifQ==
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: Unable to connect to any of the provided hosts.

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
[sudo] password for specxy:
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlJ3OHg1WmdCOVhGRkhEU3U1cFNnOk0zVWc3ZXNwR2lsRnRLYzNqdTc0cEEifQ==
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlJ3OHg1WmdCOVhGRkhEU3U1cFNnOk0zVWc3ZXNwR2lsRnRLYzNqdTc0cEEifQ==
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: Unable to connect to any of the provided hosts.

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ sudo nano /etc/hosts
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4yNDIuMTI4OjkyMDAiXSwiZmdyIjoiNDhmOTUzMWFkM2NlZjQ0ODYxNzdmNjVkYjFhZDk0NGMxZmU3OTBkY2ZlNzY2NzgxZjEyMzI1ZjhkM2RjYmJhNyIsImtleSI6IlJ3OHg1WmdCOVhGRkhEU3U1cFNnOk0zVWc3ZXNwR2lsRnRLYzNqdTc0cEEifQ==
Native global console methods have been overridden in production environment.

✖ Unable to connect to Elasticsearch with the provided enrollment token: Unable to connect to any of the provided hosts.

To generate a new enrollment token run:
  bin/elasticsearch-create-enrollment-token -s kibana
specxy@siemserver:~$ sudo systemctl status kibana.service
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 03:32:50 UTC; 3h 39min ago
       Docs: https://www.elastic.co
   Main PID: 1384 (node)
      Tasks: 11 (limit: 7564)
     Memory: 494.9M (peak: 656.5M)
        CPU: 44.101s
     CGroup: /system.slice/kibana.service
             └─1384 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 26 03:32:54 siemserver kibana[1384]: Native global console methods have been overridden in production environment.
Aug 26 03:32:58 siemserver kibana[1384]: [2025-08-26T03:32:58.066+00:00][INFO ][root] Kibana is starting
Aug 26 03:32:58 siemserver kibana[1384]: [2025-08-26T03:32:58.119+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.262+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.357+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.576+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.610+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 26 03:33:15 siemserver kibana[1384]: [2025-08-26T03:33:15.645+00:00][INFO ][root] Holding setup until preboot stage is completed.
Aug 26 03:33:23 siemserver kibana[1384]: i Kibana has not been configured.
Aug 26 03:33:23 siemserver kibana[1384]: Go to http://0.0.0.0:5601/?code=807062 to get started.

specxy@siemserver:~$ sudo systemctl stop kibana.service
specxy@siemserver:~$ sudo systemctl stop elasticsearch.service
specxy@siemserver:~$ sudo systemctl status kibana.service
○ kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: inactive (dead) since Tue 2025-08-26 07:12:42 UTC; 30s ago
   Duration: 3h 39min 51.917s
       Docs: https://www.elastic.co
    Process: 1384 ExecStart=/usr/share/kibana/bin/kibana (code=exited, status=0/SUCCESS)
   Main PID: 1384 (code=exited, status=0/SUCCESS)
        CPU: 44.198s

Aug 26 03:33:23 siemserver kibana[1384]: i Kibana has not been configured.
Aug 26 03:33:23 siemserver kibana[1384]: Go to http://0.0.0.0:5601/?code=807062 to get started.
Aug 26 07:12:42 siemserver systemd[1]: Stopping kibana.service - Kibana...
Aug 26 07:12:42 siemserver kibana[1384]: [2025-08-26T07:12:42.174+00:00][INFO ][root] SIGTERM received - initiating shutdown
Aug 26 07:12:42 siemserver kibana[1384]: [2025-08-26T07:12:42.179+00:00][INFO ][root] Kibana is shutting down
Aug 26 07:12:42 siemserver kibana[1384]: [2025-08-26T07:12:42.187+00:00][INFO ][plugins-system.preboot] Stopping all plugins.
Aug 26 07:12:42 siemserver kibana[1384]: [2025-08-26T07:12:42.190+00:00][INFO ][plugins-system.preboot] All plugins stopped.
Aug 26 07:12:42 siemserver systemd[1]: kibana.service: Deactivated successfully.
Aug 26 07:12:42 siemserver systemd[1]: Stopped kibana.service - Kibana.
Aug 26 07:12:42 siemserver systemd[1]: kibana.service: Consumed 44.198s CPU time, 656.5M memory peak, 0B memory swap peak.
specxy@siemserver:~$ sudo systemctl status elasticsearch.service
○ elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: inactive (dead) since Tue 2025-08-26 07:13:04 UTC; 34s ago
   Duration: 3h 39min 49.813s
       Docs: https://www.elastic.co
    Process: 1383 ExecStart=/usr/share/elasticsearch/bin/systemd-entrypoint -p ${PID_DIR}/elasticsearch.pid --quiet (code=exited, status=143)
   Main PID: 1383 (code=exited, status=143)
        CPU: 6min 7.937s

Aug 26 03:32:50 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 26 03:33:14 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.
Aug 26 07:13:04 siemserver systemd[1]: Stopping elasticsearch.service - Elasticsearch...
Aug 26 07:13:04 siemserver systemd[1]: elasticsearch.service: Deactivated successfully.
Aug 26 07:13:04 siemserver systemd[1]: Stopped elasticsearch.service - Elasticsearch.
Aug 26 07:13:04 siemserver systemd[1]: elasticsearch.service: Consumed 6min 7.937s CPU time, 3.8G memory peak, 0B memory swap peak.
specxy@siemserver:~$ sudo systemctl start elasticsearch.service
specxy@siemserver:~$ sudo systemctl status elasticsearch
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:14:17 UTC; 17s ago
       Docs: https://www.elastic.co
   Main PID: 4061 (java)
      Tasks: 111 (limit: 7564)
     Memory: 3.6G (peak: 3.6G)
        CPU: 47.408s
     CGroup: /system.slice/elasticsearch.service
             ├─4061 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home=/usr/share/elasticsearch >
             ├─4131 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djna.nosys=true -XX:-OmitSta>
             └─4163 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 26 07:13:56 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 26 07:14:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.
lines 1-15/15 (END)
specxy@siemserver:~$ sudo systemctl status elasticsearch.service
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:14:17 UTC; 26s ago
       Docs: https://www.elastic.co
   Main PID: 4061 (java)
      Tasks: 111 (limit: 7564)
     Memory: 3.6G (peak: 3.6G)
        CPU: 47.735s
     CGroup: /system.slice/elasticsearch.service
             ├─4061 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home=/usr/share/elasticsearch >
             ├─4131 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djna.nosys=true -XX:-OmitSta>
             └─4163 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 26 07:13:56 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 26 07:14:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.

specxy@siemserver:~$ sudo systemctl start kibana.service
specxy@siemserver:~$ sudo systemctl status kibana.service
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:15:03 UTC; 11s ago
       Docs: https://www.elastic.co
   Main PID: 4276 (node)
      Tasks: 11 (limit: 7564)
     Memory: 426.0M (peak: 427.0M)
        CPU: 8.828s
     CGroup: /system.slice/kibana.service
             └─4276 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 26 07:15:03 siemserver kibana[4276]: Kibana is currently running with legacy OpenSSL providers enabled! For details and instructions on how to disable see https://www.elastic.co/guide/en/kibana/8.19/production.html#openssl-legacy-pr>
Aug 26 07:15:04 siemserver kibana[4276]: {"log.level":"info","@timestamp":"2025-08-26T07:15:04.513Z","log.logger":"elastic-apm-node","ecs.version":"8.10.0","agentVersion":"4.13.0","env":{"pid":4276,"proctitle":"/usr/share/kibana/bin/../>
Aug 26 07:15:04 siemserver kibana[4276]: Native global console methods have been overridden in production environment.
Aug 26 07:15:05 siemserver kibana[4276]: [2025-08-26T07:15:05.532+00:00][INFO ][root] Kibana is starting
Aug 26 07:15:05 siemserver kibana[4276]: [2025-08-26T07:15:05.573+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.924+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.980+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.081+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.092+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.108+00:00][INFO ][root] Holding setup until preboot stage is completed.

specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMTo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiI0a29fNVpnQjhnd2lKN2FHT21qeTpKQTBVeWdoRk9JZjV3XzJ3ckdlLWJnIn0=
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMTo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiI0a29fNVpnQjhnd2lKN2FHT21qeTpKQTBVeWdoRk9JZjV3XzJ3ckdlLWJnIn0=
Native global console methods have been overridden in production environment.

✔ Kibana configured successfully.

To start Kibana run:
  bin/kibana
specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101

C:\Windows\System32>ssh specxy@192.168.1.101

C:\Windows\System32>ping 192.168.1.101

Pinging 192.168.1.101 with 32 bytes of data:
Reply from 192.168.1.101: bytes=32 time=1ms TTL=64
Reply from 192.168.1.101: bytes=32 time<1ms TTL=64

Ping statistics for 192.168.1.101:
    Packets: Sent = 2, Received = 2, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 1ms, Average = 0ms
Control-C
^C
C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Aug 26 08:43:41 AM UTC 2025

  System load:  0.06               Processes:              313
  Usage of /:   51.5% of 18.53GB   Users logged in:        1
  Memory usage: 69%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Tue Aug 26 06:27:01 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ traceroute 8.8.8.8
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  pfSense.home.arpa (192.168.1.1)  1.591 ms  1.840 ms  1.783 ms
 2  192.168.25.2 (192.168.25.2)  3.576 ms  2.833 ms  2.759 ms
 3  * * *
 4  * * *
 5  * * *
 6  * * *
 7  * * *
 8  * * *
 9  * * *
10  * * *
11  * * *
12  * * *
13  * * *
14  * * *
15  * * *
16  * * *
17  * * *
18  * * *
19  * * *
20  * * *
21  * * *
22  * * *
23  * * *
24  * * *
25  * * *
26  * * *
27  * * *
28  * * *
29  * * *
30  * * *
specxy@siemserver:~$ ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=127 time=50.7 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=127 time=44.2 ms
^C
--- 8.8.8.8 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 44.230/47.443/50.657/3.213 ms
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-verification-code
[sudo] password for specxy:
Your verification code is:  878 496
specxy@siemserver:~$ sudo bin\elasticsearch-create-enrollment-token.bat --scope kibana
sudo: binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:~$ bin\elasticsearch-create-enrollment-token.bat --scope kibana
binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:~$ sudo systemctl -status kibana
Failed to parse signal string "tatus".
specxy@siemserver:~$ sudo systemctl -status kibana
Failed to parse signal string "tatus".
specxy@siemserver:~$ sudo systemctl status kibana.service
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:15:03 UTC; 2h 19min ago
       Docs: https://www.elastic.co
   Main PID: 4276 (node)
      Tasks: 11 (limit: 7564)
     Memory: 275.1M (peak: 427.5M)
        CPU: 25.791s
     CGroup: /system.slice/kibana.service
             └─4276 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 26 07:15:05 siemserver kibana[4276]: [2025-08-26T07:15:05.532+00:00][INFO ][root] Kibana is starting
Aug 26 07:15:05 siemserver kibana[4276]: [2025-08-26T07:15:05.573+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.924+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.980+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.081+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.092+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.108+00:00][INFO ][root] Holding setup until preboot stage is completed.
Aug 26 07:15:18 siemserver kibana[4276]: i Kibana has not been configured.
Aug 26 07:15:18 siemserver kibana[4276]: Go to http://0.0.0.0:5601/?code=878496 to get started.
Aug 26 09:33:31 siemserver kibana[4276]: Your verification code is:  878 496

specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-verification-code
[sudo] password for specxy:
Your verification code is:  878 496
specxy@siemserver:~$ sudo systemctl status kibana.service
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:15:03 UTC; 3h 39min ago
       Docs: https://www.elastic.co
   Main PID: 4276 (node)
      Tasks: 11 (limit: 7564)
     Memory: 277.8M (peak: 427.5M)
        CPU: 34.484s
     CGroup: /system.slice/kibana.service
             └─4276 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 26 07:15:05 siemserver kibana[4276]: [2025-08-26T07:15:05.573+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.924+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.980+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.081+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.092+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.108+00:00][INFO ][root] Holding setup until preboot stage is completed.
Aug 26 07:15:18 siemserver kibana[4276]: i Kibana has not been configured.
Aug 26 07:15:18 siemserver kibana[4276]: Go to http://0.0.0.0:5601/?code=878496 to get started.
Aug 26 09:33:31 siemserver kibana[4276]: Your verification code is:  878 496
Aug 26 09:35:08 siemserver kibana[4276]: [2025-08-26T09:35:08.977+00:00][ERROR][plugins.interactiveSetup.elasticsearch] Failed to authenticate with host "https://192.168.1.101:9200": ""

specxy@siemserver:~$ ^C
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ bin\elasticsearch-create-enrollment-token.bat --scope kibana
binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:~$ cat bin\elasticsearch-create-enrollment-token.bat
cat: binelasticsearch-create-enrollment-token.bat: No such file or directory
specxy@siemserver:~$ bin\elasticsearch-create-enrollment-token.bat --scope kibana
binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:~$ sudo \bin\elasticsearch-create-enrollment-token.bat --scope kibana
[sudo] password for specxy:
sudo: binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:~$ cd /usr/share/elasticsearch
specxy@siemserver:/usr/share/elasticsearch$ ls -la
total 2336
drwxr-xr-x   9 root root    4096 Aug 25 08:54 .
drwxr-xr-x 141 root root    4096 Aug 25 05:19 ..
drwxr-xr-x   2 root root    4096 Aug 23 16:30 bin
drwxr-xr-x   2 root root    4096 Aug 25 08:46 elasticsearch
-rw-------   1 root root    6139 Aug 25 08:46 elasticsearch-ssl-http.zip
drwxr-xr-x   9 root root    4096 Aug 23 16:30 jdk
drwxr-xr-x   2 root root    4096 Aug 25 08:46 kibana
drwxr-xr-x   8 root root    4096 Aug 23 16:30 lib
drwxr-xr-x  92 root root    4096 Aug 23 16:30 modules
-rw-r--r--   1 root root 2331746 Aug 11 10:09 NOTICE.txt
drwxr-xr-x   2 root root    4096 Aug 11 10:15 plugins
-rw-r--r--   1 root root   10119 Aug 11 10:07 README.asciidoc
specxy@siemserver:/usr/share/elasticsearch$ bin\elasticsearch-create-enrollment-token.bat --scope kibana
binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:/usr/share/elasticsearch$ elasticsearch/
-bash: elasticsearch/: Is a directory
specxy@siemserver:/usr/share/elasticsearch$ cd elasticsearch/
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ bin\elasticsearch-create-enrollment-token.bat --scope kibana
binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:/usr/share/elasticsearch/elasticsearch$ cd ..
specxy@siemserver:/usr/share/elasticsearch$ cd bin/
specxy@siemserver:/usr/share/elasticsearch/bin$ ls -la
total 3340
drwxr-xr-x 2 root root    4096 Aug 23 16:30 .
drwxr-xr-x 9 root root    4096 Aug 25 08:54 ..
-rwxr-xr-x 1 root root     101 Aug 11 10:14 elasticsearch
-rwxr-xr-x 1 root root     376 Aug 11 10:11 elasticsearch-certgen
-rwxr-xr-x 1 root root     376 Aug 11 10:11 elasticsearch-certutil
-rwxr-xr-x 1 root root     706 Aug 11 10:14 elasticsearch-cli
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-create-enrollment-token
-rwxr-xr-x 1 root root     352 Aug 11 10:11 elasticsearch-croneval
-rwxr-xr-x 1 root root    2573 Aug 11 10:14 elasticsearch-env
-rwxr-xr-x 1 root root    2595 Aug 11 10:14 elasticsearch-env-from-file
-rwxr-xr-x 1 root root      84 Aug 11 10:14 elasticsearch-geoip
-rwxr-xr-x 1 root root      87 Aug 11 10:14 elasticsearch-keystore
-rwxr-xr-x 1 root root      55 Aug 11 10:14 elasticsearch-node
-rwxr-xr-x 1 root root     172 Aug 11 10:14 elasticsearch-plugin
-rwxr-xr-x 1 root root     376 Aug 11 10:11 elasticsearch-reconfigure-node
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-reset-password
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-saml-metadata
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-service-tokens
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-setup-passwords
-rwxr-xr-x 1 root root      55 Aug 11 10:14 elasticsearch-shard
-rwxr-xr-x 1 root root     403 Aug 11 10:11 elasticsearch-sql-cli
-rwxr-xr-x 1 root root 3320983 Aug 11 10:11 elasticsearch-sql-cli-8.19.2.jar
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-syskeygen
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-users
-rwxr-xr-x 1 root root     332 Aug 11 10:11 systemd-entrypoint
specxy@siemserver:/usr/share/elasticsearch/bin$ bin\elasticsearch-create-enrollment-token.bat --scope kibana
binelasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:/usr/share/elasticsearch/bin$ elasticsearch-create-enrollment-token.bat --scope kibana
elasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:/usr/share/elasticsearch/bin$ elasticsearch-create-enrollment-token.bat
elasticsearch-create-enrollment-token.bat: command not found
specxy@siemserver:/usr/share/elasticsearch/bin$ cat elasticsearch-create-enrollment-token.bat
cat: elasticsearch-create-enrollment-token.bat: No such file or directory
specxy@siemserver:/usr/share/elasticsearch/bin$ cd ..
specxy@siemserver:/usr/share/elasticsearch$ ls -la
total 2336
drwxr-xr-x   9 root root    4096 Aug 25 08:54 .
drwxr-xr-x 141 root root    4096 Aug 25 05:19 ..
drwxr-xr-x   2 root root    4096 Aug 23 16:30 bin
drwxr-xr-x   2 root root    4096 Aug 25 08:46 elasticsearch
-rw-------   1 root root    6139 Aug 25 08:46 elasticsearch-ssl-http.zip
drwxr-xr-x   9 root root    4096 Aug 23 16:30 jdk
drwxr-xr-x   2 root root    4096 Aug 25 08:46 kibana
drwxr-xr-x   8 root root    4096 Aug 23 16:30 lib
drwxr-xr-x  92 root root    4096 Aug 23 16:30 modules
-rw-r--r--   1 root root 2331746 Aug 11 10:09 NOTICE.txt
drwxr-xr-x   2 root root    4096 Aug 11 10:15 plugins
-rw-r--r--   1 root root   10119 Aug 11 10:07 README.asciidoc
specxy@siemserver:/usr/share/elasticsearch$ cd bin
specxy@siemserver:/usr/share/elasticsearch/bin$ cat
elasticsearch                          elasticsearch-create-enrollment-token  elasticsearch-geoip                    elasticsearch-reconfigure-node         elasticsearch-setup-passwords          elasticsearch-syskeygen
elasticsearch-certgen                  elasticsearch-croneval                 elasticsearch-keystore                 elasticsearch-reset-password           elasticsearch-shard                    elasticsearch-users
elasticsearch-certutil                 elasticsearch-env                      elasticsearch-node                     elasticsearch-saml-metadata            elasticsearch-sql-cli                  systemd-entrypoint
elasticsearch-cli                      elasticsearch-env-from-file            elasticsearch-plugin                   elasticsearch-service-tokens           elasticsearch-sql-cli-8.19.2.jar
specxy@siemserver:/usr/share/elasticsearch/bin$ cat
elasticsearch                          elasticsearch-create-enrollment-token  elasticsearch-geoip                    elasticsearch-reconfigure-node         elasticsearch-setup-passwords          elasticsearch-syskeygen
elasticsearch-certgen                  elasticsearch-croneval                 elasticsearch-keystore                 elasticsearch-reset-password           elasticsearch-shard                    elasticsearch-users
elasticsearch-certutil                 elasticsearch-env                      elasticsearch-node                     elasticsearch-saml-metadata            elasticsearch-sql-cli                  systemd-entrypoint
elasticsearch-cli                      elasticsearch-env-from-file            elasticsearch-plugin                   elasticsearch-service-tokens           elasticsearch-sql-cli-8.19.2.jar
specxy@siemserver:/usr/share/elasticsearch/bin$ cat
elasticsearch                          elasticsearch-create-enrollment-token  elasticsearch-geoip                    elasticsearch-reconfigure-node         elasticsearch-setup-passwords          elasticsearch-syskeygen
elasticsearch-certgen                  elasticsearch-croneval                 elasticsearch-keystore                 elasticsearch-reset-password           elasticsearch-shard                    elasticsearch-users
elasticsearch-certutil                 elasticsearch-env                      elasticsearch-node                     elasticsearch-saml-metadata            elasticsearch-sql-cli                  systemd-entrypoint
elasticsearch-cli                      elasticsearch-env-from-file            elasticsearch-plugin                   elasticsearch-service-tokens           elasticsearch-sql-cli-8.19.2.jar
specxy@siemserver:/usr/share/elasticsearch/bin$ cat elasticsearch-create-enrollment-token
#!/bin/bash

# Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
# or more contributor license agreements. Licensed under the Elastic License
# 2.0; you may not use this file except in compliance with the Elastic License
# 2.0.

CLI_LIBS="modules/x-pack-core,modules/x-pack-security"
source "`dirname "$0"`"/elasticsearch-cli
specxy@siemserver:/usr/share/elasticsearch/bin$ ls -la
total 3340
drwxr-xr-x 2 root root    4096 Aug 23 16:30 .
drwxr-xr-x 9 root root    4096 Aug 25 08:54 ..
-rwxr-xr-x 1 root root     101 Aug 11 10:14 elasticsearch
-rwxr-xr-x 1 root root     376 Aug 11 10:11 elasticsearch-certgen
-rwxr-xr-x 1 root root     376 Aug 11 10:11 elasticsearch-certutil
-rwxr-xr-x 1 root root     706 Aug 11 10:14 elasticsearch-cli
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-create-enrollment-token
-rwxr-xr-x 1 root root     352 Aug 11 10:11 elasticsearch-croneval
-rwxr-xr-x 1 root root    2573 Aug 11 10:14 elasticsearch-env
-rwxr-xr-x 1 root root    2595 Aug 11 10:14 elasticsearch-env-from-file
-rwxr-xr-x 1 root root      84 Aug 11 10:14 elasticsearch-geoip
-rwxr-xr-x 1 root root      87 Aug 11 10:14 elasticsearch-keystore
-rwxr-xr-x 1 root root      55 Aug 11 10:14 elasticsearch-node
-rwxr-xr-x 1 root root     172 Aug 11 10:14 elasticsearch-plugin
-rwxr-xr-x 1 root root     376 Aug 11 10:11 elasticsearch-reconfigure-node
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-reset-password
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-saml-metadata
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-service-tokens
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-setup-passwords
-rwxr-xr-x 1 root root      55 Aug 11 10:14 elasticsearch-shard
-rwxr-xr-x 1 root root     403 Aug 11 10:11 elasticsearch-sql-cli
-rwxr-xr-x 1 root root 3320983 Aug 11 10:11 elasticsearch-sql-cli-8.19.2.jar
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-syskeygen
-rwxr-xr-x 1 root root     353 Aug 11 10:11 elasticsearch-users
-rwxr-xr-x 1 root root     332 Aug 11 10:11 systemd-entrypoint
specxy@siemserver:/usr/share/elasticsearch/bin$
specxy@siemserver:/usr/share/elasticsearch/bin$ cd ~
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo systemctl sta
start   status
specxy@siemserver:~$ sudo systemctl sta
start   status
specxy@siemserver:~$ sudo systemctl sta
start   status
specxy@siemserver:~$ sudo systemctl status elasticsearch.service
[sudo] password for specxy:
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:14:17 UTC; 4h 42min ago
       Docs: https://www.elastic.co
   Main PID: 4061 (java)
      Tasks: 141 (limit: 7564)
     Memory: 3.6G (peak: 3.6G)
        CPU: 7min 7.101s
     CGroup: /system.slice/elasticsearch.service
             ├─4061 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home=/usr/share/elasticsearch >
             ├─4131 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djna.nosys=true -XX:-OmitSta>
             └─4163 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 26 07:13:56 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 26 07:14:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.
lines 1-15/15 (END)
specxy@siemserver:~$ sudo systemctl status kibana.service
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:15:03 UTC; 4h 41min ago
       Docs: https://www.elastic.co
   Main PID: 4276 (node)
      Tasks: 11 (limit: 7564)
     Memory: 283.2M (peak: 427.5M)
        CPU: 40.569s
     CGroup: /system.slice/kibana.service
             └─4276 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 26 07:15:05 siemserver kibana[4276]: [2025-08-26T07:15:05.573+00:00][INFO ][node] Kibana process configured with roles: [background_tasks, ui]
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.924+00:00][INFO ][plugins-service] The following plugins are disabled: "cloudChat,cloudExperiments,cloudFullStory,dataUsage,profilingDataAccess,profiling,searchHomepage,searc>
Aug 26 07:15:10 siemserver kibana[4276]: [2025-08-26T07:15:10.980+00:00][INFO ][http.server.Preboot] http server running at http://0.0.0.0:5601
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.081+00:00][INFO ][plugins-system.preboot] Setting up [1] plugins: [interactiveSetup]
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.092+00:00][INFO ][preboot] "interactiveSetup" plugin is holding setup: Validating Elasticsearch connection configuration…
Aug 26 07:15:11 siemserver kibana[4276]: [2025-08-26T07:15:11.108+00:00][INFO ][root] Holding setup until preboot stage is completed.
Aug 26 07:15:18 siemserver kibana[4276]: i Kibana has not been configured.
Aug 26 07:15:18 siemserver kibana[4276]: Go to http://0.0.0.0:5601/?code=878496 to get started.
Aug 26 09:33:31 siemserver kibana[4276]: Your verification code is:  878 496
Aug 26 09:35:08 siemserver kibana[4276]: [2025-08-26T09:35:08.977+00:00][ERROR][plugins.interactiveSetup.elasticsearch] Failed to authenticate with host "https://192.168.1.101:9200": ""

specxy@siemserver:~$ sudo /usr/share/kibana/bin/kibana-verification-code
Your verification code is:  878 496
specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101

C:\Windows\System32>ssh specxy@192.168.1.101
ssh: connect to host 192.168.1.101 port 22: Connection timed out

C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Aug 26 12:11:25 PM UTC 2025

  System load:  0.01               Processes:              315
  Usage of /:   51.5% of 18.53GB   Users logged in:        1
  Memory usage: 70%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Tue Aug 26 10:42:49 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana --url https://192.168.1.101:9200
[sudo] password for specxy:
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMTo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiI1RXBMNXBnQjhnd2lKN2FHTm1nWDptaGFpXy03bFhQTTJyOGhXTzJQYkxRIn0=
specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Aug 26 01:36:23 PM UTC 2025

  System load:  0.22               Processes:              323
  Usage of /:   51.6% of 18.53GB   Users logged in:        1
  Memory usage: 77%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Tue Aug 26 12:11:26 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Wed Aug 27 03:07:31 AM UTC 2025

  System load:  0.03               Processes:              336
  Usage of /:   51.5% of 18.53GB   Users logged in:        1
  Memory usage: 80%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Tue Aug 26 13:40:05 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ sudo systemctl status kibana.service
[sudo] password for specxy:
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:15:03 UTC; 19h ago
       Docs: https://www.elastic.co
   Main PID: 4276 (node)
      Tasks: 11 (limit: 7564)
     Memory: 1023.9M (peak: 1.2G)
        CPU: 4min 10.931s
     CGroup: /system.slice/kibana.service
             └─4276 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 27 03:07:13 siemserver kibana[4276]: [2025-08-27T03:07:13.853+00:00][INFO ][plugins.fleet.fleet:unenroll-inactive-agents-task:1.0.1] [runTask()] started
Aug 27 03:07:13 siemserver kibana[4276]: [2025-08-27T03:07:13.880+00:00][INFO ][plugins.fleet.fleet:unenroll-inactive-agents-task:1.0.1] [UnenrollInactiveAgentsTask] runTask ended: success
Aug 27 03:07:13 siemserver kibana[4276]: [2025-08-27T03:07:13.888+00:00][INFO ][plugins.fleet] Fleet Usage: {"agents_enabled":true,"agents":{"total_enrolled":0,"healthy":0,"unhealthy":0,"offline":0,"inactive":0,"unenrolled":0,"total_all>
Aug 27 03:07:16 siemserver kibana[4276]: [2025-08-27T03:07:16.897+00:00][INFO ][plugins.fleet.fleet:delete-unenrolled-agents-task:1.0.0] [runTask()] started
Aug 27 03:07:16 siemserver kibana[4276]: [2025-08-27T03:07:16.900+00:00][INFO ][plugins.fleet] Running Fleet Usage telemetry send task
Aug 27 03:07:16 siemserver kibana[4276]: [2025-08-27T03:07:16.926+00:00][INFO ][plugins.fleet.fleet:delete-unenrolled-agents-task:1.0.0] [DeleteUnenrolledAgentsTask] runTask ended: Delete unenrolled agents is disabled
Aug 27 03:07:17 siemserver kibana[4276]: [2025-08-27T03:07:17.887+00:00][INFO ][status.plugins.taskManager] taskManager plugin is now available: Task Manager is healthy
Aug 27 03:07:17 siemserver kibana[4276]: [2025-08-27T03:07:17.967+00:00][INFO ][status] Kibana is now available (was degraded)
Aug 27 03:07:18 siemserver kibana[4276]: [2025-08-27T03:07:18.627+00:00][INFO ][plugins.securitySolution.telemetry_events.sender.task.configuration] Updating sender channels configuration
Aug 27 03:07:20 siemserver kibana[4276]: [2025-08-27T03:07:20.023+00:00][INFO ][plugins.securitySolution.endpoint:metadata-check-transforms-task:0.0.1] no endpoint installation found
lines 1-21/21 (END)
specxy@siemserver:~$ sudo systemctl status elasticsearch.service
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 07:14:17 UTC; 19h ago
       Docs: https://www.elastic.co
   Main PID: 4061 (java)
      Tasks: 208 (limit: 7564)
     Memory: 3.8G (peak: 3.8G)
        CPU: 11min 42.032s
     CGroup: /system.slice/elasticsearch.service
             ├─4061 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home=/usr/share/elasticsearch >
             ├─4131 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djna.nosys=true -XX:-OmitSta>
             └─4163 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 26 07:13:56 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 26 07:14:17 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.

specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-setup-passwords auto

Failed to authenticate user 'elastic' against https://192.168.1.101:9200/_security/_authenticate?pretty
Possible causes include:
 * The password for the 'elastic' user has already been changed on this cluster
 * Your elasticsearch node is running against a different keystore
   This tool used the keystore at /etc/elasticsearch/elasticsearch.keystore

You can use the `elasticsearch-reset-password` CLI tool to reset the password of the 'elastic' user


ERROR: Failed to verify bootstrap password, with exit code 78
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic
This tool will reset the password of the [elastic] user to an autogenerated value.
The password will be printed in the console.
Please confirm that you would like to continue [y/N]y


Password for the [elastic] user successfully reset.
New value: +jPPPP5DMRk9H999k*=n
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-setup-passwords auto
[sudo] password for specxy:

Failed to authenticate user 'elastic' against https://192.168.1.101:9200/_security/_authenticate?pretty
Possible causes include:
 * The password for the 'elastic' user has already been changed on this cluster
 * Your elasticsearch node is running against a different keystore
   This tool used the keystore at /etc/elasticsearch/elasticsearch.keystore

You can use the `elasticsearch-reset-password` CLI tool to reset the password of the 'elastic' user


ERROR: Failed to verify bootstrap password, with exit code 78
specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Wed Aug 27 04:04:32 AM UTC 2025

  System load:  0.01               Processes:              322
  Usage of /:   51.5% of 18.53GB   Users logged in:        1
  Memory usage: 80%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Wed Aug 27 04:03:24 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo apt install filebeat
[sudo] password for specxy:
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  filebeat
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 66.0 MB of archives.
After this operation, 253 MB of additional disk space will be used.
Ign:1 https://artifacts.elastic.co/packages/8.x/apt stable/main amd64 filebeat amd64 8.19.2
Ign:1 https://artifacts.elastic.co/packages/8.x/apt stable/main amd64 filebeat amd64 8.19.2
Ign:1 https://artifacts.elastic.co/packages/8.x/apt stable/main amd64 filebeat amd64 8.19.2
Err:1 https://artifacts.elastic.co/packages/8.x/apt stable/main amd64 filebeat amd64 8.19.2
  Temporary failure resolving 'artifacts.elastic.co'
E: Failed to fetch https://artifacts.elastic.co/packages/8.x/apt/pool/main/f/filebeat/filebeat-8.19.2-amd64.deb  Temporary failure resolving 'artifacts.elastic.co'
E: Unable to fetch some archives, maybe run apt-get update or try with --fix-missing?
specxy@siemserver:~$ sudo apt-get update
Ign:1 http://security.ubuntu.com/ubuntu noble-security InRelease
Ign:2 https://artifacts.elastic.co/packages/8.x/apt stable InRelease
Ign:3 http://lk.archive.ubuntu.com/ubuntu noble InRelease
Ign:4 http://lk.archive.ubuntu.com/ubuntu noble-updates InRelease
Ign:2 https://artifacts.elastic.co/packages/8.x/apt stable InRelease
Ign:1 http://security.ubuntu.com/ubuntu noble-security InRelease
Ign:5 http://lk.archive.ubuntu.com/ubuntu noble-backports InRelease
Ign:2 https://artifacts.elastic.co/packages/8.x/apt stable InRelease
Ign:1 http://security.ubuntu.com/ubuntu noble-security InRelease
Ign:3 http://lk.archive.ubuntu.com/ubuntu noble InRelease
Err:1 http://security.ubuntu.com/ubuntu noble-security InRelease
  Temporary failure resolving 'security.ubuntu.com'
Err:2 https://artifacts.elastic.co/packages/8.x/apt stable InRelease
  Temporary failure resolving 'artifacts.elastic.co'
Ign:4 http://lk.archive.ubuntu.com/ubuntu noble-updates InRelease
Ign:5 http://lk.archive.ubuntu.com/ubuntu noble-backports InRelease
Ign:3 http://lk.archive.ubuntu.com/ubuntu noble InRelease
Ign:4 http://lk.archive.ubuntu.com/ubuntu noble-updates InRelease
Ign:5 http://lk.archive.ubuntu.com/ubuntu noble-backports InRelease
Err:3 http://lk.archive.ubuntu.com/ubuntu noble InRelease
  Temporary failure resolving 'lk.archive.ubuntu.com'
Err:4 http://lk.archive.ubuntu.com/ubuntu noble-updates InRelease
  Temporary failure resolving 'lk.archive.ubuntu.com'
Err:5 http://lk.archive.ubuntu.com/ubuntu noble-backports InRelease
  Temporary failure resolving 'lk.archive.ubuntu.com'
Reading package lists... Done
W: Failed to fetch https://artifacts.elastic.co/packages/8.x/apt/dists/stable/InRelease  Temporary failure resolving 'artifacts.elastic.co'
W: Failed to fetch http://lk.archive.ubuntu.com/ubuntu/dists/noble/InRelease  Temporary failure resolving 'lk.archive.ubuntu.com'
W: Failed to fetch http://lk.archive.ubuntu.com/ubuntu/dists/noble-updates/InRelease  Temporary failure resolving 'lk.archive.ubuntu.com'
W: Failed to fetch http://lk.archive.ubuntu.com/ubuntu/dists/noble-backports/InRelease  Temporary failure resolving 'lk.archive.ubuntu.com'
W: Failed to fetch http://security.ubuntu.com/ubuntu/dists/noble-security/InRelease  Temporary failure resolving 'security.ubuntu.com'
W: Some index files failed to download. They have been ignored, or old ones used instead.
specxy@siemserver:~$ sudo poweroff

Broadcast message from root@siemserver on pts/2 (Wed 2025-08-27 04:16:49 UTC):

The system will power off now!

specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101

C:\Windows\System32>ping 192.168.1.101

Pinging 192.168.1.101 with 32 bytes of data:
Reply from 192.168.1.101: bytes=32 time<1ms TTL=64
Reply from 192.168.1.101: bytes=32 time=1ms TTL=64

Ping statistics for 192.168.1.101:
    Packets: Sent = 2, Received = 2, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 1ms, Average = 0ms
Control-C
^C
C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-78-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Wed Aug 27 04:22:51 AM UTC 2025

  System load:  0.33               Processes:              357
  Usage of /:   53.4% of 18.53GB   Users logged in:        1
  Memory usage: 77%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


*** System restart required ***
Last login: Wed Aug 27 04:04:32 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo apt install filebeat
[sudo] password for specxy:
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  filebeat
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 66.0 MB of archives.
After this operation, 253 MB of additional disk space will be used.
Get:1 https://artifacts.elastic.co/packages/8.x/apt stable/main amd64 filebeat amd64 8.19.2 [66.0 MB]
Fetched 66.0 MB in 15s (4,364 kB/s)
Selecting previously unselected package filebeat.
(Reading database ... 253648 files and directories currently installed.)
Preparing to unpack .../filebeat_8.19.2_amd64.deb ...
Unpacking filebeat (8.19.2) ...
Setting up filebeat (8.19.2) ...
Scanning processes...
Scanning linux images...

Pending kernel upgrade!
Running kernel version:
  6.8.0-78-generic
Diagnostics:
  The currently running kernel version is not the expected kernel version 6.8.0-79-generic.

Restarting the system to load the new kernel will not be handled automatically, so you should consider rebooting.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s filebeat
[sudo] password for specxy:
The scope of this enrollment token, can only be one of [node, kibana]
Creates enrollment tokens for elasticsearch nodes and kibana instances

Option (* = required)  Description
---------------------  -----------
-E <KeyValuePair>      Configure a setting
-f, --force            Use this option to force execution of the command
                         against a cluster that is currently unhealthy.
-h, --help             Show help
* -s, --scope          The scope of this enrollment token, can be either "node"
                         or "kibana"
--url                  the URL where the elasticsearch node listens for
                         connections.
-v, --verbose          Show verbose output


ERROR: Invalid scope, with exit code 64
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token --scope filebeat --url https://192.168.1.101:9200
The scope of this enrollment token, can only be one of [node, kibana]
Creates enrollment tokens for elasticsearch nodes and kibana instances

Option (* = required)  Description
---------------------  -----------
-E <KeyValuePair>      Configure a setting
-f, --force            Use this option to force execution of the command
                         against a cluster that is currently unhealthy.
-h, --help             Show help
* -s, --scope          The scope of this enrollment token, can be either "node"
                         or "kibana"
--url                  the URL where the elasticsearch node listens for
                         connections.
-v, --verbose          Show verbose output


ERROR: Invalid scope, with exit code 64
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token
Creates enrollment tokens for elasticsearch nodes and kibana instances

Option (* = required)  Description
---------------------  -----------
-E <KeyValuePair>      Configure a setting
-f, --force            Use this option to force execution of the command
                         against a cluster that is currently unhealthy.
-h, --help             Show help
* -s, --scope          The scope of this enrollment token, can be either "node"
                         or "kibana"
--url                  the URL where the elasticsearch node listens for
                         connections.
-v, --verbose          Show verbose output

ERROR: Missing required option(s) [s/scope]
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s filebeat
The scope of this enrollment token, can only be one of [node, kibana]
Creates enrollment tokens for elasticsearch nodes and kibana instances

Option (* = required)  Description
---------------------  -----------
-E <KeyValuePair>      Configure a setting
-f, --force            Use this option to force execution of the command
                         against a cluster that is currently unhealthy.
-h, --help             Show help
* -s, --scope          The scope of this enrollment token, can be either "node"
                         or "kibana"
--url                  the URL where the elasticsearch node listens for
                         connections.
-v, --verbose          Show verbose output


ERROR: Invalid scope, with exit code 64
specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s node
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMTo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJrUDBCNnBnQmtJVElNaTBaeEdqUzp6TlhocFRMRjM4WUxUQVpKWGJ1V05RIn0=
specxy@siemserver:~$ sudo /usr/share/filebeat/bin/filebeat setup --enrollment-token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMTo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJrUDBCNnBnQmtJVElNaTBaeEdqUzp6TlhocFRMRjM4WUxUQVpKWGJ1V05RIn0=
Error: unknown flag: --enrollment-token
Usage:
  filebeat setup [flags]

Flags:
      --dashboards                     Setup dashboards
      --enable-all-filesets            Behave as if all modules and filesets had been enabled
      --force-enable-module-filesets   Behave as if all filesets, within enabled modules, are enabled
  -h, --help                           help for setup
      --index-management               Setup all components related to Elasticsearch index management, including template, ilm policy and rollover alias
      --modules string                 List of enabled modules (comma separated)
      --pipelines                      Setup Ingest pipelines

Global Flags:
  -E, --E setting=value              Configuration overwrite
  -M, --M setting=value              Module configuration overwrite
  -c, --c string                     Configuration file, relative to path.config (default "filebeat.yml")
  -d, --d string                     Enable certain debug selectors
  -e, --e                            Log to stderr and disable syslog/file output
      --environment environmentVar   set environment being ran in (default default)
      --path.config string           Configuration path
      --path.data string             Data path
      --path.home string             Home path
      --path.logs string             Logs path
      --plugin pluginList            Load additional plugins
      --strict.perms                 Strict permission checking on config files (default true)
  -v, --v                            Log at INFO level

specxy@siemserver:~$ sudo /usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s node
[sudo] password for specxy:
eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMTo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJrdjBVNnBnQmtJVElNaTBaTFdoejpMZnJzVjNPQTlsSXp2S3I0WC1SUWlBIn0=
specxy@siemserver:~$ sudo /usr/share/filebeat/bin/filebeat setup --token eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTkyLjE2OC4xLjEwMTo5MjAwIl0sImZnciI6IjQ4Zjk1MzFhZDNjZWY0NDg2MTc3ZjY1ZGIxYWQ5NDRjMWZlNzkwZGNmZTc2Njc4MWYxMjMyNWY4ZDNkY2JiYTciLCJrZXkiOiJrdjBVNnBnQmtJVElNaTBaTFdoejpMZnJzVjNPQTlsSXp2S3I0WC1SUWlBIn0=
Error: unknown flag: --token
Usage:
  filebeat setup [flags]

Flags:
      --dashboards                     Setup dashboards
      --enable-all-filesets            Behave as if all modules and filesets had been enabled
      --force-enable-module-filesets   Behave as if all filesets, within enabled modules, are enabled
  -h, --help                           help for setup
      --index-management               Setup all components related to Elasticsearch index management, including template, ilm policy and rollover alias
      --modules string                 List of enabled modules (comma separated)
      --pipelines                      Setup Ingest pipelines

Global Flags:
  -E, --E setting=value              Configuration overwrite
  -M, --M setting=value              Module configuration overwrite
  -c, --c string                     Configuration file, relative to path.config (default "filebeat.yml")
  -d, --d string                     Enable certain debug selectors
  -e, --e                            Log to stderr and disable syslog/file output
      --environment environmentVar   set environment being ran in (default default)
      --path.config string           Configuration path
      --path.data string             Data path
      --path.home string             Home path
      --path.logs string             Logs path
      --plugin pluginList            Load additional plugins
      --strict.perms                 Strict permission checking on config files (default true)
  -v, --v                            Log at INFO level

specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
[sudo] password for specxy:
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
specxy@siemserver:~$ specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo filebeat setup
Exiting: couldn't connect to any of the configured Elasticsearch hosts. Errors: [error connecting to Elasticsearch at http://localhost:9200: Get "http://localhost:9200": EOF]
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
specxy@siemserver:~$ sudo filebeat setup
Exiting: couldn't connect to any of the configured Elasticsearch hosts. Errors: [error connecting to Elasticsearch at https://localhost:9200: Get "https://localhost:9200": x509: certificate signed by unknown authority]
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
specxy@siemserver:~$ sudo find /etc/elasticsearch /usr/share/elasticsearch -name "http_ca.crt"h -name "http_ca.crt"
/etc/elasticsearch/certs/http_ca.crt
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
specxy@siemserver:~$ sudo find /etc/elasticsearch /usr/share/elasticsearch -name "http_ca.crt"
/etc/elasticsearch/certs/http_ca.crt
specxy@siemserver:~$ sudo filebeat setup
Overwriting lifecycle policy is disabled. Set `setup.ilm.overwrite: true` to overwrite.
Index setup finished.
Loading dashboards (Kibana must be running and reachable)
Loaded dashboards
Loaded Ingest pipelines
specxy@siemserver:~$ sudo nano /etc/filebeat/filebeat.yml
[sudo] password for specxy:
specxy@siemserver:~$ specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo systemctl enable filebeat
Created symlink /etc/systemd/system/multi-user.target.wants/filebeat.service → /usr/lib/systemd/system/filebeat.service.
specxy@siemserver:~$ sudo systemctl start filebeat
specxy@siemserver:~$ sudo systemctl status filebeat
● filebeat.service - Filebeat sends log files to Logstash or directly to Elasticsearch.
     Loaded: loaded (/usr/lib/systemd/system/filebeat.service; enabled; preset: enabled)
     Active: active (running) since Wed 2025-08-27 08:15:47 UTC; 14s ago
       Docs: https://www.elastic.co/beats/filebeat
   Main PID: 8697 (filebeat)
      Tasks: 17 (limit: 7564)
     Memory: 81.7M (peak: 82.6M)
        CPU: 915ms
     CGroup: /system.slice/filebeat.service
             └─8697 /usr/share/filebeat/bin/filebeat --environment systemd -c /etc/filebeat/filebeat.yml --path.home /usr/share/filebeat --path.config /etc/filebeat --path.data /var/lib/filebeat --path.logs /var/log/filebeat

Aug 27 08:15:47 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:47.597Z","log.logger":"crawler","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cfgfile.(*Reloader).Run","file.name":"cfgfile/re>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.584Z","log.logger":"processors.add_cloud_metadata","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/processors/add_cloud_metad>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.604Z","log.logger":"publisher_pipeline_output","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/publisher/pipeline.(*netClient>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.618Z","log.logger":"elasticsearch.esclientleg","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/esleg/eslegclient.(*Connection>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.619Z","log.logger":"index-management","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/idxmgmt.(*indexManager).Setup","file.na>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.623Z","log.logger":"index-management.ilm","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/idxmgmt/lifecycle.(*stdManager).Ens>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.623Z","log.logger":"index-management","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/idxmgmt.applyLifecycleSettingsToTemplat>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.636Z","log.logger":"template_loader","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/template.(*ESLoader).Load","file.name":">
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.636Z","log.logger":"index-management","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/idxmgmt.(*indexManager).Setup","file.na>
Aug 27 08:15:50 siemserver filebeat[8697]: {"log.level":"info","@timestamp":"2025-08-27T08:15:50.637Z","log.logger":"publisher_pipeline_output","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/publisher/pipeline.(*netClient>

specxy@siemserver:~$
specxy@siemserver:~$ sudo poweroff
[sudo] password for specxy:

Broadcast message from root@siemserver on pts/2 (Wed 2025-08-27 10:20:04 UTC):

The system will power off now!

specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-79-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Wed Aug 27 11:03:02 AM UTC 2025

  System load:  0.15               Processes:              306
  Usage of /:   55.4% of 18.53GB   Users logged in:        1
  Memory usage: 78%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   16%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Wed Aug 27 04:23:19 2025 from 192.168.1.3
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ traceroute 8.8.8.8
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  _gateway (192.168.1.1)  4.499 ms  3.280 ms  3.075 ms
 2  192.168.25.2 (192.168.25.2)  4.514 ms  4.561 ms  4.972 ms
 3  * * *
 4  * * *
 5  * * *
 6  * * *
 7  * * *
 8  *^C
specxy@siemserver:~$ traceroute 192
traceroute to 192 (0.0.0.192), 30 hops max, 60 byte packets
 1  _gateway (192.168.1.1)  2.445 ms  1.982 ms  1.704 ms
 2  192.168.25.2 (192.168.25.2)  3.170 ms  3.100 ms  3.021 ms
 3  192.168.25.2 (192.168.25.2)  4.361 ms !N  4.286 ms !N  4.683 ms !N
specxy@siemserver:~$ traceroute 192.168.1.105
traceroute to 192.168.1.105 (192.168.1.105), 30 hops max, 60 byte packets
 1  * * *
 2  * * *
 3  * * *
 4  * * *
 5  * * *
 6  *^C
specxy@siemserver:~$ ping 192.168.1.105
PING 192.168.1.105 (192.168.1.105) 56(84) bytes of data.
^C
--- 192.168.1.105 ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3099ms

specxy@siemserver:~$ ping 192.168.1.105
PING 192.168.1.105 (192.168.1.105) 56(84) bytes of data.
^C
--- 192.168.1.105 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1062ms

specxy@siemserver:~$ ping 192.168.1.105
PING 192.168.1.105 (192.168.1.105) 56(84) bytes of data.
64 bytes from 192.168.1.105: icmp_seq=1 ttl=128 time=1.80 ms
64 bytes from 192.168.1.105: icmp_seq=2 ttl=128 time=2.03 ms
^C
--- 192.168.1.105 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 1.804/1.915/2.027/0.111 ms
specxy@siemserver:~$ ping 192.168.1.105
PING 192.168.1.105 (192.168.1.105) 56(84) bytes of data.
64 bytes from 192.168.1.105: icmp_seq=1 ttl=128 time=1.66 ms
64 bytes from 192.168.1.105: icmp_seq=2 ttl=128 time=2.28 ms
^C
--- 192.168.1.105 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 1.663/1.973/2.283/0.310 ms
specxy@siemserver:~$ client_loop: send disconnect: Connection reset

C:\Windows\System32>ssh specxy@192.168.1.101
specxy@192.168.1.101's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-79-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Thu Aug 28 03:21:28 AM UTC 2025

  System load:  0.36               Processes:              323
  Usage of /:   55.4% of 18.53GB   Users logged in:        1
  Memory usage: 75%                IPv4 address for ens33: 192.168.1.101
  Swap usage:   20%


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


Last login: Wed Aug 27 11:03:03 2025 from 192.168.1.3
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$
specxy@siemserver:~$ sudo systemctl status kibana.service
[sudo] password for specxy:
● kibana.service - Kibana
     Loaded: loaded (/usr/lib/systemd/system/kibana.service; enabled; preset: enabled)
     Active: active (running) since Wed 2025-08-27 10:24:16 UTC; 18h ago
       Docs: https://www.elastic.co
   Main PID: 1358 (node)
      Tasks: 11 (limit: 4888)
     Memory: 894.1M (peak: 1.3G swap: 22.0M swap peak: 22.1M)
        CPU: 6min 22.034s
     CGroup: /system.slice/kibana.service
             └─1358 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist

Aug 28 04:20:43 siemserver kibana[1358]: [2025-08-28T04:20:43.923+00:00][INFO ][plugins.fleet.fleet:unenroll-inactive-agents-task:1.0.1] [UnenrollInactiveAgentsTask] runTask ended: success
Aug 28 04:20:43 siemserver kibana[1358]: [2025-08-28T04:20:43.931+00:00][INFO ][plugins.fleet] Fleet Usage: {"agents_enabled":true,"agents":{"total_enrolled":0,"healthy":0,"unhealthy":0,"offline":0,"inactive":0,"unenrolled":0,"total_all>
Aug 28 04:20:46 siemserver kibana[1358]: [2025-08-28T04:20:46.864+00:00][INFO ][plugins.fleet.fleet:delete-unenrolled-agents-task:1.0.0] [runTask()] started
Aug 28 04:20:46 siemserver kibana[1358]: [2025-08-28T04:20:46.866+00:00][INFO ][plugins.fleet] Running Fleet Usage telemetry send task
Aug 28 04:20:46 siemserver kibana[1358]: [2025-08-28T04:20:46.887+00:00][INFO ][plugins.fleet.fleet:delete-unenrolled-agents-task:1.0.0] [DeleteUnenrolledAgentsTask] runTask ended: Delete unenrolled agents is disabled
Aug 28 04:30:43 siemserver kibana[1358]: [2025-08-28T04:30:43.905+00:00][INFO ][plugins.fleet.fleet:unenroll-inactive-agents-task:1.0.1] [runTask()] started
Aug 28 04:30:43 siemserver kibana[1358]: [2025-08-28T04:30:43.942+00:00][INFO ][plugins.fleet.fleet:unenroll-inactive-agents-task:1.0.1] [UnenrollInactiveAgentsTask] runTask ended: success
Aug 28 04:35:43 siemserver kibana[1358]: [2025-08-28T04:35:43.958+00:00][INFO ][plugins.fleet] Fleet Usage: {"agents_enabled":true,"agents":{"total_enrolled":0,"healthy":0,"unhealthy":0,"offline":0,"inactive":0,"unenrolled":0,"total_all>
Aug 28 04:40:43 siemserver kibana[1358]: [2025-08-28T04:40:43.917+00:00][INFO ][plugins.fleet.fleet:unenroll-inactive-agents-task:1.0.1] [runTask()] started
Aug 28 04:40:43 siemserver kibana[1358]: [2025-08-28T04:40:43.965+00:00][INFO ][plugins.fleet.fleet:unenroll-inactive-agents-task:1.0.1] [UnenrollInactiveAgentsTask] runTask ended: success

specxy@siemserver:~$ sudo systemctl status elasticsearch.service
● elasticsearch.service - Elasticsearch
     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)
     Active: active (running) since Wed 2025-08-27 10:24:54 UTC; 18h ago
       Docs: https://www.elastic.co
   Main PID: 1356 (java)
      Tasks: 206 (limit: 4888)
     Memory: 2.1G (peak: 2.7G swap: 703.2M swap peak: 724.8M)
        CPU: 11min 9.814s
     CGroup: /system.slice/elasticsearch.service
             ├─1356 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.home=/usr/share/elasticsearch >
             ├─1469 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djna.nosys=true -XX:-OmitSta>
             └─1538 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller

Aug 27 10:24:16 siemserver systemd[1]: Starting elasticsearch.service - Elasticsearch...
Aug 27 10:24:54 siemserver systemd[1]: Started elasticsearch.service - Elasticsearch.

specxy@siemserver:~$ sudo systemctl status filebeat.service
● filebeat.service - Filebeat sends log files to Logstash or directly to Elasticsearch.
     Loaded: loaded (/usr/lib/systemd/system/filebeat.service; enabled; preset: enabled)
     Active: active (running) since Wed 2025-08-27 10:24:16 UTC; 18h ago
       Docs: https://www.elastic.co/beats/filebeat
   Main PID: 1357 (filebeat)
      Tasks: 17 (limit: 4888)
     Memory: 56.8M (peak: 187.8M swap: 37.7M swap peak: 38.1M)
        CPU: 13.940s
     CGroup: /system.slice/filebeat.service
             └─1357 /usr/share/filebeat/bin/filebeat --environment systemd -c /etc/filebeat/filebeat.yml --path.home /usr/share/filebeat --path.config /etc/filebeat --path.data /var/lib/filebeat --path.logs /var/log/filebeat

Aug 28 04:37:31 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:37:31.377Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:38:01 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:38:01.374Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:38:31 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:38:31.379Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:39:01 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:39:01.378Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:39:31 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:39:31.376Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:40:01 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:40:01.378Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:40:31 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:40:31.377Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:41:01 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:41:01.376Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:41:31 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:41:31.379Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
Aug 28 04:42:01 siemserver filebeat[1357]: {"log.level":"info","@timestamp":"2025-08-28T04:42:01.377Z","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot>
lines 1-21/21 (END)
specxy@siemserver:~$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:00:ab:1f brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.1.101/24 brd 192.168.1.255 scope global ens33
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe00:ab1f/64 scope link
       valid_lft forever preferred_lft forever
specxy@siemserver:~$ traceroute 8.8.8.8
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  _gateway (192.168.1.1)  1.258 ms  2.770 ms  1.842 ms
 2  192.168.25.2 (192.168.25.2)  1.805 ms  1.771 ms  1.734 ms
 3  * * *
 4  * * *
 5  * * *
 6  * * *
 7  * * *
 8  *^C
specxy@siemserver:~$ whoami
specxy
specxy@siemserver:~$
